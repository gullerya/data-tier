!function(e){"use strict";function t(e){return p.indexOf(e.constructor.name)>=0}function n(e,n,r){var a,l=e.hasOwnProperty(n),p=e[n],h=s.get(e),d=u.get(h.root);if((a=r&&"object"==typeof r&&!t(r)?Reflect.set(e,n,new o(r,n,h).proxy):Reflect.set(e,n,r))&&(c.has(p)&&(s.get(c.get(p)).revoke(),c.delete(p)),d.hasListeners)){var y=h.path.concat(n),v=[];v.push(l?new f(y,r,p):new i(y,r)),h.preventCallbacks||d.notify(v)}return a}function r(e,t){var n,r=e[t],o=s.get(e),a=u.get(o.root);if((n=Reflect.deleteProperty(e,t))&&(c.has(r)&&(s.get(c.get(r)).revoke(),c.delete(r)),a.hasListeners)){var i=o.path.concat(t),f=[];f.push(new l(i,r)),o.preventCallbacks||a.notify(f)}return n}function o(e,a,p){var h,d;if(!e||"object"!=typeof e)throw new Error("Observed MUST be created from a non null object origin");if(p&&(void 0===a||null===a))throw new Error("any non-root (parent-less) Observed MUST have an own path; now parent is "+p+"; key is "+a);if(p&&!(p instanceof o))throw new Error("parent, when supplied, MUST be an instance of Observed");h=function(e){return Array.isArray(e)?e.slice():Object.assign(new e.constructor,e)}(e),Array.isArray(h)?(!function(e,n){e.forEach(function(r,a){r&&"object"==typeof r&&!t(r)&&(e[a]=new o(r,a,n).proxy)})}(h,this),d=Proxy.revocable(h,{set:n,get:function(e,t){var n=s.get(e),r=u.get(n.root);return"pop"===t?function(){var o,a,i;return o=e.length-1,(a=Reflect.apply(e[t],e,arguments))&&"object"==typeof a&&(a=c.get(a),s.get(a).revoke()),i=[new l(n.path.concat(o),a)],r.notify(i),a}:"push"===t?function(){var a,f,l,c=[];return a=Array.from(arguments),l=e.length,a.forEach(function(e,t){e&&"object"==typeof e&&(a[t]=new o(e,l+t,n).proxy),c.push(new i(n.path.concat(l+t),e))}),f=Reflect.apply(e[t],e,a),r.notify(c),f}:"shift"===t?function(){var o,a,i;return(o=Reflect.apply(e[t],e,arguments))&&"object"==typeof o&&(o=c.get(o),s.get(o).revoke()),e.forEach(function(e,t){e&&"object"==typeof e&&((i=s.get(c.get(e)))?i.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),a=[new l(n.path.concat(0),o)],r.notify(a),o}:"unshift"===t?function(){var a,f,l,u=[];(a=Array.from(arguments)).forEach(function(e,t){e&&"object"==typeof e&&(a[t]=new o(e,t,n).proxy)}),f=Reflect.apply(e[t],e,a),e.forEach(function(e,t){e&&"object"==typeof e&&((l=s.get(c.get(e)))?l.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))});for(var p=0;p<a.length;p++)u.push(new i(n.path.concat(p),e[p]));return r.notify(u),f}:"reverse"===t?function(){var n,o=[];return Reflect.apply(e[t],e,arguments),e.forEach(function(e,t){e&&"object"==typeof e&&((n=s.get(c.get(e)))?n.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),o.push(new function(){Reflect.defineProperty(this,"type",{value:"reverse"})}),r.notify(o),this}:"sort"===t?function(){var n,o=[];return Reflect.apply(e[t],e,arguments),e.forEach(function(e,t){e&&"object"==typeof e&&((n=s.get(c.get(e)))?n.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),o.push(new function(){Reflect.defineProperty(this,"type",{value:"shuffle"})}),r.notify(o),this}:"fill"===t?function(){var a,l,u,p=[];a=arguments.length<2?0:arguments[1]<0?e.length+arguments[1]:arguments[1],l=arguments.length<3?e.length:arguments[2]<0?e.length+arguments[2]:arguments[2],u=e.slice(),Reflect.apply(e[t],e,arguments);for(var h=a;h<l;h++)e[h]&&"object"==typeof e[h]&&(e[h]=new o(e[h],h,n).proxy),u.hasOwnProperty(h)?(p.push(new f(n.path.concat(h),e[h],u[h]&&"object"==typeof u[h]?c.get(u[h]):u[h])),u[h]&&"object"==typeof u[h]&&s.get(c.get(u[h])).revoke()):p.push(new i(n.path.concat(h),e[h]));return r.notify(p),this}:"splice"===t?function(){var a,u,p,h,d,y,v,g=[];for((a=Array.from(arguments)).forEach(function(e,t){t>1&&e&&"object"==typeof e&&(a[t]=new o(e,t,n).proxy)}),d=0===a.length?0:a[0]<0?e.length+a[0]:a[0],y=a.length<2?e.length-d:a[1],v=Math.max(a.length-2,0),u=Reflect.apply(e[t],e,a),e.forEach(function(e,t){e&&"object"==typeof e&&((p=s.get(c.get(e)))?p.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),u.forEach(function(e,t){e&&"object"==typeof e&&(u[t]=c.get(e),s.get(u[t]).revoke())}),h=0;h<y;h++)h<v?g.push(new f(n.path.concat(d+h),e[d+h],u[h])):g.push(new l(n.path.concat(d+h),u[h]));for(;h<v;h++)g.push(new i(n.path.concat(d+h),e[d+h]));return r.notify(g),u}:Reflect.get(e,t)},deleteProperty:r})):(!function(e,n){Reflect.ownKeys(e).forEach(function(r){e[r]&&"object"==typeof e[r]&&!t(e[r])&&(e[r]=new o(e[r],r,n).proxy)})}(h,this),d=Proxy.revocable(h,{set:n,deleteProperty:r})),s.set(h,this),c.set(d.proxy,h),Reflect.defineProperty(this,"revokable",{value:d}),Reflect.defineProperty(this,"proxy",{value:d.proxy}),Reflect.defineProperty(this,"parent",{value:p}),Reflect.defineProperty(this,"ownKey",{value:a,writable:!0})}function a(e){var t=!1,n=[];Reflect.defineProperty(e.proxy,"observe",{value:function(e){if(t)throw new TypeError("revoked Observable MAY NOT be observed anymore");if("function"!=typeof e)throw new Error("observer (callback) parameter MUST be a function");n.indexOf(e)<0?n.push(e):console.info("observer (callback) may be bound to an observable only once")}}),Reflect.defineProperty(e.proxy,"unobserve",{value:function(){if(t)throw new TypeError("revoked Observable MAY NOT be unobserved amymore");arguments.length?Array.from(arguments).forEach(function(e){var t=n.indexOf(e);t>=0&&n.splice(t,1)}):n.splice(0,n.length)}}),Reflect.defineProperty(e.proxy,"revoke",{value:function(){t?console.log("revokation of Observable have an effect only once"):(t=!0,e.revoke())}}),Reflect.defineProperty(this,"hasListeners",{get:function(){return n.length>0}}),Reflect.defineProperty(this,"notify",{value:function(e){n.forEach(function(t){try{t(e)}catch(e){console.error(e)}})}})}function i(e,t){Reflect.defineProperty(this,"type",{value:"insert"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"value",{value:t})}function f(e,t,n){Reflect.defineProperty(this,"type",{value:"update"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"value",{value:t}),Reflect.defineProperty(this,"oldValue",{value:n})}function l(e,t){Reflect.defineProperty(this,"type",{value:"delete"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"oldValue",{value:t})}var c=new Map,s=new Map,u=new Map,p=["Date","Blob","Number","String","Boolean","Error","SyntaxError","TypeError","URIError","Function","Promise","RegExp"];Reflect.defineProperty(o.prototype,"root",{get:function(){for(var e=this;e.parent;)e=e.parent;return e}}),Reflect.defineProperty(o.prototype,"path",{get:function(){for(var e=[],t=this;void 0!==t.ownKey;)e.push(t.ownKey),t=t.parent;return e.reverse()}}),Reflect.defineProperty(o.prototype,"revoke",{value:function(){var e=this.proxy;Reflect.ownKeys(e).forEach(function(t){var n=e[t];c.has(n)&&(s.get(c.get(n)).revoke(),c.get(e)[t]=c.get(n))}),this.revokable.revoke()}}),Reflect.defineProperty(a,"from",{value:function(e){if(!e||"object"!=typeof e)throw new Error("observable MAY ONLY be created from non-null object only");if("observe"in e||"unobserve"in e||"revoke"in e)throw new Error('target object MUST NOT have nor own neither inherited properties from the following list: "observe", "unobserve", "revoke"');if(t(e))throw new Error(e+" found to be one of non-observable object types: "+p);var n=new o(e),r=new a(n);return u.set(n,r),n.proxy}}),Reflect.defineProperty(e,"Observable",{value:a})}(this),(()=>{"use strict";function e(e){if(void 0===e||null===e)return e;if("object"!=typeof e)throw new Error(e+" is not of type Observable and not an object");if("function"==typeof e.observe&&"function"==typeof e.unobserve&&"function"==typeof e.revoke)return e;if(t.Observable){if("function"==typeof e.observe||"function"==typeof e.unobserve||"function"==typeof e.revoke)throw new Error(e+" is not of type Observable and can not be transformed into Observable (some of its functions already implemented?)");return t.Observable.from(e)}throw new Error(e+" is not of type Observable and no embedded Observable implementation found")}(()=>{let e=window,t=Symbol.for("data-tier");for(;e.parent!==e;)e=e.parent;if(e[t])throw new Error("data-tier found to already being running within this application, cancelling current execution");e[t]=!0})();const t=this||window,n={};Reflect.defineProperty(t,"DataTier",{value:{}}),Reflect.defineProperty(t.DataTier,"ties",{value:{get get(){return function(e){return n[e]}},get create(){return function(r,o,a){if(function(e){if(!e||"string"!=typeof e)throw new Error("tie name MUST be a non-empty string");if(/\W/.test(e))throw new Error("tie name MUST consist of alphanumerics or underlines ([a-zA-Z0-9_]) ONLY")}(r),n[r])throw new Error("existing tie ("+r+") MAY NOT be re-created, use the tie's own APIs to reconfigure it");return new function(r,o,a){let i;Reflect.defineProperty(this,"name",{value:r}),Reflect.defineProperty(this,"data",{get:function(){return i},set:function(n){let o=i,a=e(n);i&&i.revoke(),(i=a)&&i.observe(function(e){t.DataTier.views.processChanges(r,e)}),t.DataTier.views.processChanges(r,[{type:"update",value:i,oldValue:o,path:[]}])}}),n[r]=this,this.data=o,Object.seal(this)}(r,e(o),a)}},get remove(){return function(e){e&&n[e]&&(n[e].observable.revoke(),delete n[e])}}}})})(),(()=>{"use strict";function e(e,r){Reflect.defineProperty(this,"name",{value:e}),Reflect.defineProperty(this,"toView",{value:r.toView}),Reflect.defineProperty(this,"toData",{value:"function"==typeof r.toData?r.toData:function(e){!function(e,t,n){let r;if(!e)return;for(r=0;r<t.length-1;r++)e=e[t[r]]&&"object"==typeof e[t[r]]?e[t[r]]:e[t[r]]={};e[t[r]]=n}(e.data,e.path,e.view.value)}}),Reflect.defineProperty(this,"changeDOMEventType",{value:"string"==typeof r.changeDOMEventType?r.changeDOMEventType:null}),Reflect.defineProperty(this,"parseParam",{value:"function"==typeof r.parseParam?r.parseParam:t}),Reflect.defineProperty(this,"isChangedPathRelevant",{value:"function"==typeof r.isChangedPathRelevant?r.isChangedPathRelevant:n})}function t(e){let t="",n=[];return e&&(t=(n=e.trim().split(".")).shift()),{tieName:t,dataPath:n}}function n(e,t){return t.startsWith(e)}const r=this||window,o={};if(!r.DataTier)throw new Error("data-tier framework was not properly initialized");Reflect.defineProperty(e.prototype,"parseParam",{value:t}),Reflect.defineProperty(e.prototype,"isChangedPathRelevant",{value:n}),Reflect.defineProperty(r.DataTier,"processors",{value:{get get(){return function(e){return o[e]}},get add(){return function(t,n){if("string"!=typeof t||!t)throw new Error("name MUST be a non-empty string");if(o[t])throw new Error('data processor "'+t+'" already exists; you may want to reconfigure the existing one');if("object"!=typeof n||!n)throw new Error("configuration MUST be a non-null object");if("function"!=typeof n.toView)throw new Error('configuration MUST have a "toView" function defined');o[t]=new e(t,n),r.DataTier.views.applyProcessor(o[t])}},get remove(){return function(e){if("string"!=typeof e||!e)throw new Error("controller name MUST be a non-empty string");return delete o[e]}},get getApplicable(){return function(e){let t=[];return e&&e.dataset&&Object.keys(e.dataset).filter(e=>e in o).map(e=>o[e]).forEach(e=>t.push(e)),t}}}})})(),(()=>{"use strict";function e(e){let t,n,r,o=e.target,a=l.getApplicable(o);for(let i=0,l=a.length;i<l;i++)if(t=a[i],e.type===t.changeDOMEventType){if(n=t.parseParam(o.dataset[t.name]),r=f.get(n.tieName),!n.dataPath)return void console.error("path to data not available");if(!r)return void console.error('tie "'+n.tieName+'" not found');t.toData({data:r.data,path:n.dataPath,view:o})}}function t(t){if("IFRAME"===t.nodeName)a(t.contentDocument),t.addEventListener("load",function(){a(this.contentDocument),r(this.contentDocument)}),r(t.contentDocument);else if(t.dataset){let r,o,a,i,f,u,p,h=Object.keys(t.dataset);let d=0;for(h.length;r=h[d];d++)r.startsWith("tie")&&((o=l.get(r))?(i=(a=o.parseParam(t.dataset[o.name])).dataPath.join("."),(p=(u=(f=c[a.tieName]||(c[a.tieName]={}))[o.name]||(f[o.name]={}))[i]||(u[i]=[])).indexOf(t)<0&&(p.push(t),n(t,o.name),o.changeDOMEventType&&function(t,n){t.addEventListener(n,e)}(t,o.changeDOMEventType))):(s[r]||(s[r]=[]),s[r].push(t)))}}function n(e,t){let n,r,o,a;r=(n=l.get(t)).parseParam(e.dataset[t]),(o=f.get(r.tieName))&&(a=function(e,t){if(e){for(let n=0,r=t.length;n<r;n++){if(!(t[n]in e))return;e=e[t[n]]}return e}}(o.data,r.dataPath),n.toView(a,e))}function r(e){if(e&&(e.nodeType===Node.DOCUMENT_NODE||e.nodeType===Node.ELEMENT_NODE)){let n;n="IFRAME"===e.nodeName?e.contentDocument.getElementsByTagName("*"):e.getElementsByTagName("*"),t(e);for(let e=0,r=n.length;e<r;e++)t(n[e])}}function o(t){if(t&&t.getElementsByTagName){let n,r,o,a,i,f,s=t.getElementsByTagName("*");for(let u=0,p=s.length;u<=p;u++)if((n=u<p?s[u]:t).dataset&&n.dataset.length)for(let t=0,s=(r=l.getApplicable(n)).length;t<s;t++)a=(o=r[t]).parseParam(n.dataset[o.name]),(f=(i=c[a.tieName][o.name][a.dataPath.join(".")]).indexOf(n))>=0&&(i.splice(f,1),o.changeDOMEventType&&function(t,n){t.removeEventListener(n,e)}(n,o.changeDOMEventType))}}function a(e){new MutationObserver(function(e){let t,i,f,s,u,p,h,d,y,v;for(t=0;t<e.length;t++)if(p=e[t],"attributes"===(h=p.type)){let e=p.target,t=p.attributeName;0===t.indexOf("data-tie")?function(e,t,r,o){let a,i,f=-1;a=l.get(t).parseParam(r),c[a.tieName]&&c[a.tieName][t]&&((i=c[a.tieName][t][a.dataPath])&&(f=i.indexOf(e)),f>=0&&i.splice(f,1)),a=l.get(t).parseParam(o),c[a.tieName]||(c[a.tieName]={}),c[a.tieName][t]||(c[a.tieName][t]={}),c[a.tieName][t][a.dataPath]||(c[a.tieName][t][a.dataPath]=[]),c[a.tieName][t][a.dataPath].push(e),n(e,t)}(e,function(e){let n,r=2,o=t.split("-");for(n=o[1];r<o.length;)n+=o[r][0].toUpperCase()+o[r++].substr(1);return n}(),p.oldValue,e.getAttribute(t)):"src"===t&&"IFRAME"===e.nodeName&&o(e.contentDocument)}else if("childList"===h){for(i=0,s=(d=p.addedNodes).length;i<s;i++)"IFRAME"===(v=d[i]).nodeName?(v.contentDocument&&(a(v.contentDocument),r(v.contentDocument)),v.addEventListener("load",function(){a(this.contentDocument),r(this.contentDocument)})):r(v);for(f=0,u=(y=p.removedNodes).length;f<u;f++)o("IFRAME"===(v=y[f]).nodeName?v.contentDocument:v)}}).observe(e,{childList:!0,attributes:!0,characterData:!1,subtree:!0,attributeOldValue:!0,characterDataOldValue:!1})}const i=this||window;if(!i.DataTier)throw new Error("data-tier framework was not properly initialized");const f=i.DataTier.ties,l=i.DataTier.processors,c={},s={};Reflect.defineProperty(i.DataTier,"views",{value:{get processChanges(){return function(e,t){let r,o,a,i,f,s,u,p,h,d,y,v,g,w,b,m,P,E=c[e];if(E)for(d=0,y=t.length;d<y;d++)for(o=(r=t[d]).path.join("."),v=0,g=(a=Object.keys(E)).length;v<g;v++)if(i=a[v],p=E[i])for(f=l.get(i),w=0,b=(s=Object.keys(p)).length;w<b;w++)if(u=s[w],f.isChangedPathRelevant(o,u))for(m=0,P=(h=p[u]).length;m<P;m++)n(h[m],i)}},get applyProcessor(){return function(e){s[e.name]&&(s[e.name].forEach(t),delete s[e.name])}}}}),a(document),r(document)})(),(()=>{"use strict";const e=this||window,t=e.DataTier.processors.add;if(!e.DataTier)throw new Error("data-tier framework was not properly initialized");t("tieValue",{toView:function(e,t){"checkbox"===t.type?t.checked=e:t.value=void 0!==e&&null!==e?e:""},changeDOMEventType:"change"}),t("tieText",{toView:function(e,t){t.textContent=void 0!==e&&null!==e?e:""}}),t("tiePlaceholder",{toView:function(e,t){t.placeholder=void 0!==e&&null!==e?e:""}}),t("tieTooltip",{toView:function(e,t){t.title=void 0!==e&&null!==e?e:""}}),t("tieSrc",{toView:function(e,t){t.src=void 0!==e&&null!==e?e:""}}),t("tieHRef",{toView:function(e,t){t.href=void 0!==e&&null!==e?e:""}}),t("tieDateValue",{toView:function(e,t){t.value=void 0!==e&&null!==e?e.toLocaleString():""}}),t("tieDateText",{toView:function(e,t){t.textContent=void 0!==e&&null!==e?e.toLocaleString():""}}),t("tieClasses",{isChangedPathRelevant:function(e,t){let n=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===n.length||2===n.length&&""===n[0]},toView:function(e,t){e&&"object"==typeof e&&Object.keys(e).forEach(function(n){e[n]?t.classList.add(n):t.classList.remove(n)})}}),t("tieList",{parseParam:function(e){return this.constructor.prototype.parseParam(e.split(/\s*=>\s*/)[0])},isChangedPathRelevant:function(e,t){let n=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===n.length||2===n.length&&""===n[0]},toView:function(e,t){if(!Array.isArray(e)||!t)return;let n,r,o,a,i,f,l,c=t.parentNode,s=e.length;if("TEMPLATE"!==t.nodeName)throw new Error("tieList may be defined on template elements only");t.dataset.listSourceAid||(t.dataset.listSourceAid=(new Date).getTime());let u=c.querySelectorAll('[data-list-item-aid="'+t.dataset.listSourceAid+'"]');for(l=u.length;l>s;)c.removeChild(u[--l]);if(l<s)if((r=t.dataset.tieList.trim().split(/\s+/))&&3===r.length&&"=>"===r[1]){o=r[2],i=(a=t.ownerDocument).createDocumentFragment();let e,u,p,h,d,y,v,g,w,b,m,P=[],E=r[0]+".";for(;l<s;l++){if(n=a.importNode(t.content,!0),e=n.querySelectorAll("*"),u||(u=e.length),!P.length)for(p=0;p<u;p++){for(h=Object.keys(e[p].dataset),d=[],y=0;y<h.length;y++)d.push([h[y],e[p].dataset[h[y]]]);P.push(d)}for(v=0;g=P[v];v++)for(b=0,w=g.length;b<w;b++)(m=g[b])[1].startsWith(o)&&(e[v].dataset[m[0]]=m[1].replace(o,E+l));for(i.appendChild(n),f=i.lastChild;f.nodeType!==Node.ELEMENT_NODE&&null!==f.previousSibling;)f=f.previousSibling;f.dataset.listItemAid=t.dataset.listSourceAid}c.appendChild(i)}else console.error('invalid parameter for "tieList" rule specified')}})})();