!function(e){"use strict";function t(e){return Array.isArray(e)?e.slice():Object.assign(new e.constructor,e)}function n(e){return m.indexOf(e.constructor.name)>=0}function o(e,t){var n=v.get(e),o=g.get(n.root);return"pop"===t?function(){var r,a,i;return r=e.length-1,(a=Reflect.apply(e[t],e,arguments))&&"object"==typeof a&&(a=y.get(a),v.get(a).revoke()),i=[new p(n.path.concat(r),a)],o.notify(i),a}:"push"===t?function(){var r,a,i,c=[];return r=Array.from(arguments),i=e.length,r.forEach(function(e,t){e&&"object"==typeof e&&(r[t]=new f(e,i+t,n).proxy),c.push(new l(n.path.concat(i+t),e))}),a=Reflect.apply(e[t],e,r),o.notify(c),a}:"shift"===t?function(){var r,a,i;return(r=Reflect.apply(e[t],e,arguments))&&"object"==typeof r&&(r=y.get(r),v.get(r).revoke()),e.forEach(function(e,t){e&&"object"==typeof e&&((i=v.get(y.get(e)))?i.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),a=[new p(n.path.concat(0),r)],o.notify(a),r}:"unshift"===t?function(){var r,a,i,c=[];(r=Array.from(arguments)).forEach(function(e,t){e&&"object"==typeof e&&(r[t]=new f(e,t,n).proxy)}),a=Reflect.apply(e[t],e,r),e.forEach(function(e,t){e&&"object"==typeof e&&((i=v.get(y.get(e)))?i.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))});for(var s=0;s<r.length;s++)c.push(new l(n.path.concat(s),e[s]));return o.notify(c),a}:"reverse"===t?function(){var n,r=[];return Reflect.apply(e[t],e,arguments),e.forEach(function(e,t){e&&"object"==typeof e&&((n=v.get(y.get(e)))?n.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),r.push(new h),o.notify(r),this}:"sort"===t?function(){var n,r=[];return Reflect.apply(e[t],e,arguments),e.forEach(function(e,t){e&&"object"==typeof e&&((n=v.get(y.get(e)))?n.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),r.push(new d),o.notify(r),this}:"fill"===t?function(){var r,a,i,c=[];r=arguments.length<2?0:arguments[1]<0?e.length+arguments[1]:arguments[1],a=arguments.length<3?e.length:arguments[2]<0?e.length+arguments[2]:arguments[2],i=e.slice(),Reflect.apply(e[t],e,arguments);for(var s=r;s<a;s++)e[s]&&"object"==typeof e[s]&&(e[s]=new f(e[s],s,n).proxy),i.hasOwnProperty(s)?(c.push(new u(n.path.concat(s),e[s],i[s]&&"object"==typeof i[s]?y.get(i[s]):i[s])),i[s]&&"object"==typeof i[s]&&v.get(y.get(i[s])).revoke()):c.push(new l(n.path.concat(s),e[s]));return o.notify(c),this}:"splice"===t?function(){var r,a,i,c,s,h,d,g=[];for((r=Array.from(arguments)).forEach(function(e,t){t>1&&e&&"object"==typeof e&&(r[t]=new f(e,t,n).proxy)}),s=0===r.length?0:r[0]<0?e.length+r[0]:r[0],h=r.length<2?e.length-s:r[1],d=Math.max(r.length-2,0),a=Reflect.apply(e[t],e,r),e.forEach(function(e,t){e&&"object"==typeof e&&((i=v.get(y.get(e)))?i.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),a.forEach(function(e,t){e&&"object"==typeof e&&(a[t]=y.get(e),v.get(a[t]).revoke())}),c=0;c<h;c++)c<d?g.push(new u(n.path.concat(s+c),e[s+c],a[c])):g.push(new p(n.path.concat(s+c),a[c]));for(;c<d;c++)g.push(new l(n.path.concat(s+c),e[s+c]));return o.notify(g),a}:Reflect.get(e,t)}function r(e,t,o){var r,a=e.hasOwnProperty(t),i=e[t],c=v.get(e),s=g.get(c.root);if((r=o&&"object"==typeof o&&!n(o)?Reflect.set(e,t,new f(o,t,c).proxy):Reflect.set(e,t,o))&&(y.has(i)&&(v.get(y.get(i)).revoke(),y.delete(i)),s.hasListeners)){var p=c.path.concat(t),h=[];h.push(a?new u(p,o,i):new l(p,o)),c.preventCallbacks||s.notify(h)}return r}function a(e,t){var n,o=e[t],r=v.get(e),a=g.get(r.root);if((n=Reflect.deleteProperty(e,t))&&(y.has(o)&&(v.get(y.get(o)).revoke(),y.delete(o)),a.hasListeners)){var i=r.path.concat(t),c=[];c.push(new p(i,o)),r.preventCallbacks||a.notify(c)}return n}function i(e,t){e.forEach(function(o,r){o&&"object"==typeof o&&!n(o)&&(e[r]=new f(o,r,t).proxy)})}function c(e,t){Reflect.ownKeys(e).forEach(function(o){e[o]&&"object"==typeof e[o]&&!n(e[o])&&(e[o]=new f(e[o],o,t).proxy)})}function f(e,n,s){var l,u;if(!e||"object"!=typeof e)throw new Error("Observed MUST be created from a non null object origin");if(s&&(void 0===n||null===n))throw new Error("any non-root (parent-less) Observed MUST have an own path; now parent is "+s+"; key is "+n);if(s&&!(s instanceof f))throw new Error("parent, when supplied, MUST be an instance of Observed");l=t(e),Array.isArray(l)?(i(l,this),u=Proxy.revocable(l,{set:r,get:o,deleteProperty:a})):(c(l,this),u=Proxy.revocable(l,{set:r,deleteProperty:a})),v.set(l,this),y.set(u.proxy,l),Reflect.defineProperty(this,"revokable",{value:u}),Reflect.defineProperty(this,"proxy",{value:u.proxy}),Reflect.defineProperty(this,"parent",{value:s}),Reflect.defineProperty(this,"ownKey",{value:n,writable:!0})}function s(e){function t(e){if(a)throw new TypeError("revoked Observable MAY NOT be observed anymore");if("function"!=typeof e)throw new Error("observer (callback) parameter MUST be a function");i.indexOf(e)<0?i.push(e):console.info("observer (callback) may be bound to an observable only once")}function n(){if(a)throw new TypeError("revoked Observable MAY NOT be unobserved amymore");arguments.length?Array.from(arguments).forEach(function(e){var t=i.indexOf(e);t>=0&&i.splice(t,1)}):i.splice(0,i.length)}function o(){a?console.log("revokation of Observable have an effect only once"):(a=!0,e.revoke())}function r(e){i.forEach(function(t){try{t(e)}catch(e){console.error(e)}})}var a=!1,i=[];Reflect.defineProperty(e.proxy,"observe",{value:t}),Reflect.defineProperty(e.proxy,"unobserve",{value:n}),Reflect.defineProperty(e.proxy,"revoke",{value:o}),Reflect.defineProperty(this,"hasListeners",{get:function(){return i.length>0}}),Reflect.defineProperty(this,"notify",{value:r})}function l(e,t){Reflect.defineProperty(this,"type",{value:"insert"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"value",{value:t})}function u(e,t,n){Reflect.defineProperty(this,"type",{value:"update"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"value",{value:t}),Reflect.defineProperty(this,"oldValue",{value:n})}function p(e,t){Reflect.defineProperty(this,"type",{value:"delete"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"oldValue",{value:t})}function h(){Reflect.defineProperty(this,"type",{value:"reverse"})}function d(){Reflect.defineProperty(this,"type",{value:"shuffle"})}var y=new Map,v=new Map,g=new Map,m=["Date","Blob","Number","String","Boolean","Error","SyntaxError","TypeError","URIError","Function","Promise","RegExp"];Reflect.defineProperty(f.prototype,"root",{get:function(){for(var e=this;e.parent;)e=e.parent;return e}}),Reflect.defineProperty(f.prototype,"path",{get:function(){for(var e=[],t=this;void 0!==t.ownKey;)e.push(t.ownKey),t=t.parent;return e.reverse()}}),Reflect.defineProperty(f.prototype,"revoke",{value:function(){var e=this.proxy;Reflect.ownKeys(e).forEach(function(t){var n=e[t];y.has(n)&&(v.get(y.get(n)).revoke(),y.get(e)[t]=y.get(n))}),this.revokable.revoke()}}),Reflect.defineProperty(s,"from",{value:function(e){if(!e||"object"!=typeof e)throw new Error("observable MAY ONLY be created from non-null object only");if("observe"in e||"unobserve"in e||"revoke"in e)throw new Error('target object MUST NOT have nor own neither inherited properties from the following list: "observe", "unobserve", "revoke"');if(n(e))throw new Error(e+" found to be one of non-observable object types: "+m);var t=new f(e),o=new s(t);return g.set(t,o),t.proxy}}),Reflect.defineProperty(e,"Observable",{value:s})}(this),function(e){"use strict";function t(t,n,o){function r(n){e.DataTier.views.processChanges(t,n)}let i;Reflect.defineProperty(this,"name",{value:t}),Reflect.defineProperty(this,"data",{get:function(){return i},set:function(n){n&&(a(n),i&&i.revoke());let o=i;(i=n)&&i.observe(r),e.DataTier.views.processChanges(t,[{type:"update",value:i,oldValue:o,path:[]}])}}),c[t]=this,this.data=n}function n(e,n,o){if(r(e),n&&a(n),c[e])throw new Error("existing tie ("+e+") MAY NOT be re-created, use the tie's own APIs to reconfigure it");return new t(e,n,o)}function o(e){e&&c[e]&&(c[e].observable.revoke(),delete c[e])}function r(e){if(!e||"string"!=typeof e)throw new Error("tie name MUST be a non-empty string");if(/\W/.test(e))throw new Error("tie name MUST consist of alphanumerics or underlines ([a-zA-Z0-9_]) ONLY")}function a(e){if(!e||"object"!=typeof e||"function"!=typeof e.observe||"function"!=typeof e.unobserve||"function"!=typeof e.revoke)throw new Error(e+" is not a valid Observable")}function i(e,t,n){let o;if(e){for(o=0;o<t.length-1;o++)e=e[t[o]]||{};e[t[o]]=n}}const c={};t.prototype.viewToDataProcessor=function(e){i(e.data,e.path,e.view.value)},Reflect.defineProperty(e,"DataTier",{value:{}}),Reflect.defineProperty(e.DataTier,"ties",{value:{}}),Reflect.defineProperty(e.DataTier.ties,"get",{value:function(e){return c[e]}}),Reflect.defineProperty(e.DataTier.ties,"create",{value:n}),Reflect.defineProperty(e.DataTier.ties,"remove",{value:o})}(this),function(e){"use strict";function t(e,t){Reflect.defineProperty(this,"name",{value:e}),Reflect.defineProperty(this,"dataToView",{value:t.dataToView}),"function"==typeof t.inputToData&&Reflect.defineProperty(this,"inputToData",{value:t.inputToData}),"function"==typeof t.parseParam&&Reflect.defineProperty(this,"parseParam",{value:t.parseParam}),"function"==typeof t.isChangedPathRelevant&&Reflect.defineProperty(this,"isChangedPathRelevant",{value:t.isChangedPathRelevant})}function n(n,o){if("string"!=typeof n||!n)throw new Error("name MUST be a non-empty string");if(i[n])throw new Error('controller "'+n+'" already exists; you may want to reconfigure the existing controller');if("object"!=typeof o||!o)throw new Error("configuration MUST be a non-null object");if("function"!=typeof o.dataToView)throw new Error('configuration MUST have a "dataToView" function defined');i[n]=new t(n,o),e.DataTier.views.applyController(i[n])}function o(e){return i[e]}function r(e){if("string"!=typeof e||!e)throw new Error("controller name MUST be a non-empty string");return delete i[e]}function a(e){let t=[];return e&&e.nodeType===Node.ELEMENT_NODE&&e.dataset&&Object.keys(e.dataset).forEach(function(e){i[e]&&t.push(i[e])}),t}const i={};t.prototype.parseParam=function(e){let t="",n=[];return e&&(t=(n=e.trim().split(".")).shift()),{tieName:t,dataPath:n}},t.prototype.isChangedPathRelevant=function(e,t){return 0===t.indexOf(e)},Reflect.defineProperty(e.DataTier,"controllers",{value:{get get(){return o},get add(){return n},get remove(){return r},get getApplicable(){return a}}})}(this),function(e){"use strict";function t(e,t){let n;if(e){for(n=0;n<t.length;n++)if(!(e=e[t[n]]))return;return e}}function n(t){e.DataTier.controllers.getApplicable(t.target).forEach(function(n){if("tieValue"===n.name){let o=n.parseParam(t.target.dataset[n.name]),r=e.DataTier.ties.get(o.tieName);if(!o.dataPath)return void console.error("path to data not available");if(!r)return void console.error('tie "'+o.tieName+'" not found');r.viewToDataProcessor({data:r.data,path:o.dataPath,view:t.target})}})}function o(e){"INPUT"!==e.nodeName&&"SELECT"!==e.nodeName||e.addEventListener("change",n)}function r(e){e.removeEventListener("change",n)}function a(t){"IFRAME"===t.nodeName?(h(t.contentDocument),t.addEventListener("load",function(){h(this.contentDocument),c(this.contentDocument)}),c(t.contentDocument)):(e.DataTier.controllers.getApplicable(t).forEach(function(e){let n,r,a,c=e.parseParam(t.dataset[e.name]),f=c.dataPath.join(".");d[c.tieName]||(d[c.tieName]={}),(n=d[c.tieName])[e.name]||(n[e.name]={}),(r=n[e.name])[f]||(r[f]=[]),(a=r[f]).indexOf(t)<0&&(a.push(t),i(t,e.name),o(t))}),t.dataset&&Object.keys(t.dataset).forEach(function(n){0!==n.indexOf("tie")||e.DataTier.controllers.get(n)||(y[n]||(y[n]=[]),y[n].push(t))}))}function i(n,o){let r,a,i,c;a=(r=e.DataTier.controllers.get(o)).parseParam(n.dataset[o]),(i=e.DataTier.ties.get(a.tieName))&&(c=t(i.data,a.dataPath),r.dataToView(c,n))}function c(e){let t;e&&e.nodeType&&(e.nodeType===Node.DOCUMENT_NODE||e.nodeType===Node.ELEMENT_NODE)&&((t=t="IFRAME"===e.nodeName?Array.from(e.contentDocument.getElementsByTagName("*")):Array.from(e.getElementsByTagName("*"))).push(e),t.forEach(a))}function f(t){let n,o,a,i;t&&t.getElementsByTagName&&((n=Array.from(t.getElementsByTagName("*"))).push(t),n.forEach(function(t){e.DataTier.controllers.getApplicable(t).forEach(function(e){o=e.parseParam(t.dataset[e.name]),a=d[o.tieName][e.name][o.dataPath.join(".")],(i=a.indexOf(t))>=0&&(a.splice(i,1),r(t))})}))}function s(t,n,o,r){let a,c,f=-1;a=e.DataTier.controllers.get(n).parseParam(o),d[a.tieName]&&d[a.tieName][n]&&((c=d[a.tieName][n][a.dataPath])&&(f=c.indexOf(t)),f>=0&&c.splice(f,1)),a=e.DataTier.controllers.get(n).parseParam(r),d[a.tieName]||(d[a.tieName]={}),d[a.tieName][n]||(d[a.tieName][n]={}),d[a.tieName][n][a.dataPath]||(d[a.tieName][n][a.dataPath]=[]),d[a.tieName][n][a.dataPath].push(t),i(t,n)}function l(t,n){let o,r,a,c=d[t];c&&n.forEach(function(t){a=t.path.join("."),Object.keys(c).forEach(function(t){(r=c[t])&&(o=e.DataTier.controllers.get(t),Object.keys(r).forEach(function(e){o.isChangedPathRelevant(a,e)&&r[e].forEach(function(e){i(e,t)})}))})})}function u(e){y[e.name]&&(y[e.name].forEach(function(e){a(e)}),delete y[e.name])}function p(e){let t,n=2,o=e.split("-");for(t=o[1];n<o.length;)t+=o[n][0].toUpperCase()+o[n++].substr(1);return t}function h(e){function t(e){e.forEach(function(e){let t=e.target,n=e.attributeName;"attributes"===e.type&&0===n.indexOf("data-tie")?s(t,p(n),e.oldValue,t.getAttribute(n)):"attributes"===e.type&&"src"===n&&"IFRAME"===t.nodeName?f(t.contentDocument):"childList"===e.type&&(Array.from(e.addedNodes).forEach(function(e){"IFRAME"===e.nodeName?(e.contentDocument&&(h(e.contentDocument),c(e.contentDocument)),e.addEventListener("load",function(){h(this.contentDocument),c(this.contentDocument)})):c(e)}),Array.from(e.removedNodes).forEach(function(e){f("IFRAME"===e.nodeName?e.contentDocument:e)}))})}new MutationObserver(t).observe(e,{childList:!0,subtree:!0,attributes:!0,attributeOldValue:!0,characterData:!1,characterDataOldValue:!1})}const d={},y={};Reflect.defineProperty(e.DataTier,"views",{value:{get processChanges(){return l},get applyController(){return u}}}),h(document),c(document)}(this),function(e){"use strict";const t=e.DataTier.controllers.add;t("tieValue",{dataToView:function(e,t){"checkbox"===t.type?t.checked=e:t.value=e||""}}),t("tieText",{dataToView:function(e,t){t.textContent=e?e.toString():""}}),t("tiePlaceholder",{dataToView:function(e,t){t.placeholder=e||""}}),t("tieTooltip",{dataToView:function(e,t){t.title=e||""}}),t("tieSrc",{dataToView:function(e,t){t.src=e||""}}),t("tieHRef",{dataToView:function(e,t){t.href=e||""}}),t("tieDateValue",{dataToView:function(e,t){t.value=e?e.toLocaleString():""}}),t("tieDateText",{dataToView:function(e,t){t.textContent=e?e.toLocaleString():""}}),t("tieClasses",{isChangedPathRelevant:function(e,t){let n=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===n.length||2===n.length&&""===n[0]},dataToView:function(e,t){e&&"object"==typeof e&&Object.keys(e).forEach(function(n){e[n]?t.classList.add(n):t.classList.remove(n)})}}),t("tieList",{parseParam:function(e){return this.constructor.prototype.parseParam(e.split(/\s*=>\s*/)[0])},isChangedPathRelevant:function(e,t){let n=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===n.length||2===n.length&&""===n[0]},dataToView:function(e,t){let n,o,r,a,i,c,f,s,l=t.parentNode;if("TEMPLATE"!==t.nodeName)throw new Error("tieList may be defined on template elements only");if(t.dataset.listSourceAid||(t.dataset.listSourceAid=(new Date).getTime()),n=function(e,t){let n=Array.from(l.querySelectorAll('[data-list-item-aid="'+t+'"]'));for(;n.length>e;)l.removeChild(n.pop());return n.length}(e?e.length:0,t.dataset.listSourceAid),e&&n<e.length)if((r=t.dataset.tieList.trim().split(/\s+/))&&3===r.length&&"=>"===r[1]){for(a=r[2],f=(c=t.ownerDocument).createDocumentFragment();n<e.length;n++){for(o=c.importNode(t.content,!0),(i=Array.prototype.slice.call(o.querySelectorAll("*"),0)).forEach(function(e){Object.keys(e.dataset).forEach(function(t){0===e.dataset[t].indexOf(a)&&(e.dataset[t]=e.dataset[t].replace(a,r[0]+"."+n))})}),f.appendChild(o),s=f.lastChild;s.nodeType!==Node.ELEMENT_NODE&&null!==s.previousSibling;)s=s.previousSibling;s.dataset.listItemAid=t.dataset.listSourceAid}l.appendChild(f)}else console.error('invalid parameter for "tieList" rule specified')}})}(this);