!function(e){"use strict";function t(e){return Array.isArray(e)?e.slice():Object.assign(new e.constructor,e)}function n(e){return w.indexOf(e.constructor.name)>=0}function o(e,t){var n=v.get(e),o=g.get(n.root);return"pop"===t?function(){var r,a,i;return r=e.length-1,(a=Reflect.apply(e[t],e,arguments))&&"object"==typeof a&&(a=y.get(a),v.get(a).revoke()),i=[new p(n.path.concat(r),a)],o.notify(i),a}:"push"===t?function(){var r,a,i,c=[];return r=Array.from(arguments),i=e.length,r.forEach(function(e,t){e&&"object"==typeof e&&(r[t]=new f(e,i+t,n).proxy),c.push(new l(n.path.concat(i+t),e))}),a=Reflect.apply(e[t],e,r),o.notify(c),a}:"shift"===t?function(){var r,a,i;return(r=Reflect.apply(e[t],e,arguments))&&"object"==typeof r&&(r=y.get(r),v.get(r).revoke()),e.forEach(function(e,t){e&&"object"==typeof e&&((i=v.get(y.get(e)))?i.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),a=[new p(n.path.concat(0),r)],o.notify(a),r}:"unshift"===t?function(){var r,a,i,c=[];(r=Array.from(arguments)).forEach(function(e,t){e&&"object"==typeof e&&(r[t]=new f(e,t,n).proxy)}),a=Reflect.apply(e[t],e,r),e.forEach(function(e,t){e&&"object"==typeof e&&((i=v.get(y.get(e)))?i.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))});for(var s=0;s<r.length;s++)c.push(new l(n.path.concat(s),e[s]));return o.notify(c),a}:"reverse"===t?function(){var n,r=[];return Reflect.apply(e[t],e,arguments),e.forEach(function(e,t){e&&"object"==typeof e&&((n=v.get(y.get(e)))?n.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),r.push(new h),o.notify(r),this}:"sort"===t?function(){var n,r=[];return Reflect.apply(e[t],e,arguments),e.forEach(function(e,t){e&&"object"==typeof e&&((n=v.get(y.get(e)))?n.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),r.push(new d),o.notify(r),this}:"fill"===t?function(){var r,a,i,c=[];r=arguments.length<2?0:arguments[1]<0?e.length+arguments[1]:arguments[1],a=arguments.length<3?e.length:arguments[2]<0?e.length+arguments[2]:arguments[2],i=e.slice(),Reflect.apply(e[t],e,arguments);for(var s=r;s<a;s++)e[s]&&"object"==typeof e[s]&&(e[s]=new f(e[s],s,n).proxy),i.hasOwnProperty(s)?(c.push(new u(n.path.concat(s),e[s],i[s]&&"object"==typeof i[s]?y.get(i[s]):i[s])),i[s]&&"object"==typeof i[s]&&v.get(y.get(i[s])).revoke()):c.push(new l(n.path.concat(s),e[s]));return o.notify(c),this}:"splice"===t?function(){var r,a,i,c,s,h,d,g=[];for((r=Array.from(arguments)).forEach(function(e,t){t>1&&e&&"object"==typeof e&&(r[t]=new f(e,t,n).proxy)}),s=0===r.length?0:r[0]<0?e.length+r[0]:r[0],h=r.length<2?e.length-s:r[1],d=Math.max(r.length-2,0),a=Reflect.apply(e[t],e,r),e.forEach(function(e,t){e&&"object"==typeof e&&((i=v.get(y.get(e)))?i.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),a.forEach(function(e,t){e&&"object"==typeof e&&(a[t]=y.get(e),v.get(a[t]).revoke())}),c=0;c<h;c++)c<d?g.push(new u(n.path.concat(s+c),e[s+c],a[c])):g.push(new p(n.path.concat(s+c),a[c]));for(;c<d;c++)g.push(new l(n.path.concat(s+c),e[s+c]));return o.notify(g),a}:Reflect.get(e,t)}function r(e,t,o){var r,a=e.hasOwnProperty(t),i=e[t],c=v.get(e),s=g.get(c.root);if((r=o&&"object"==typeof o&&!n(o)?Reflect.set(e,t,new f(o,t,c).proxy):Reflect.set(e,t,o))&&(y.has(i)&&(v.get(y.get(i)).revoke(),y.delete(i)),s.hasListeners)){var p=c.path.concat(t),h=[];h.push(a?new u(p,o,i):new l(p,o)),c.preventCallbacks||s.notify(h)}return r}function a(e,t){var n,o=e[t],r=v.get(e),a=g.get(r.root);if((n=Reflect.deleteProperty(e,t))&&(y.has(o)&&(v.get(y.get(o)).revoke(),y.delete(o)),a.hasListeners)){var i=r.path.concat(t),c=[];c.push(new p(i,o)),r.preventCallbacks||a.notify(c)}return n}function i(e,t){e.forEach(function(o,r){o&&"object"==typeof o&&!n(o)&&(e[r]=new f(o,r,t).proxy)})}function c(e,t){Reflect.ownKeys(e).forEach(function(o){e[o]&&"object"==typeof e[o]&&!n(e[o])&&(e[o]=new f(e[o],o,t).proxy)})}function f(e,n,s){var l,u;if(!e||"object"!=typeof e)throw new Error("Observed MUST be created from a non null object origin");if(s&&(void 0===n||null===n))throw new Error("any non-root (parent-less) Observed MUST have an own path; now parent is "+s+"; key is "+n);if(s&&!(s instanceof f))throw new Error("parent, when supplied, MUST be an instance of Observed");l=t(e),Array.isArray(l)?(i(l,this),u=Proxy.revocable(l,{set:r,get:o,deleteProperty:a})):(c(l,this),u=Proxy.revocable(l,{set:r,deleteProperty:a})),v.set(l,this),y.set(u.proxy,l),Reflect.defineProperty(this,"revokable",{value:u}),Reflect.defineProperty(this,"proxy",{value:u.proxy}),Reflect.defineProperty(this,"parent",{value:s}),Reflect.defineProperty(this,"ownKey",{value:n,writable:!0})}function s(e){function t(e){if(a)throw new TypeError("revoked Observable MAY NOT be observed anymore");if("function"!=typeof e)throw new Error("observer (callback) parameter MUST be a function");i.indexOf(e)<0?i.push(e):console.info("observer (callback) may be bound to an observable only once")}function n(){if(a)throw new TypeError("revoked Observable MAY NOT be unobserved amymore");arguments.length?Array.from(arguments).forEach(function(e){var t=i.indexOf(e);t>=0&&i.splice(t,1)}):i.splice(0,i.length)}function o(){a?console.log("revokation of Observable have an effect only once"):(a=!0,e.revoke())}function r(e){i.forEach(function(t){try{t(e)}catch(e){console.error(e)}})}var a=!1,i=[];Reflect.defineProperty(e.proxy,"observe",{value:t}),Reflect.defineProperty(e.proxy,"unobserve",{value:n}),Reflect.defineProperty(e.proxy,"revoke",{value:o}),Reflect.defineProperty(this,"hasListeners",{get:function(){return i.length>0}}),Reflect.defineProperty(this,"notify",{value:r})}function l(e,t){Reflect.defineProperty(this,"type",{value:"insert"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"value",{value:t})}function u(e,t,n){Reflect.defineProperty(this,"type",{value:"update"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"value",{value:t}),Reflect.defineProperty(this,"oldValue",{value:n})}function p(e,t){Reflect.defineProperty(this,"type",{value:"delete"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"oldValue",{value:t})}function h(){Reflect.defineProperty(this,"type",{value:"reverse"})}function d(){Reflect.defineProperty(this,"type",{value:"shuffle"})}var y=new Map,v=new Map,g=new Map,w=["Date","Blob","Number","String","Boolean","Error","SyntaxError","TypeError","URIError","Function","Promise","RegExp"];Reflect.defineProperty(f.prototype,"root",{get:function(){for(var e=this;e.parent;)e=e.parent;return e}}),Reflect.defineProperty(f.prototype,"path",{get:function(){for(var e=[],t=this;void 0!==t.ownKey;)e.push(t.ownKey),t=t.parent;return e.reverse()}}),Reflect.defineProperty(f.prototype,"revoke",{value:function(){var e=this.proxy;Reflect.ownKeys(e).forEach(function(t){var n=e[t];y.has(n)&&(v.get(y.get(n)).revoke(),y.get(e)[t]=y.get(n))}),this.revokable.revoke()}}),Reflect.defineProperty(s,"from",{value:function(e){if(!e||"object"!=typeof e)throw new Error("observable MAY ONLY be created from non-null object only");if("observe"in e||"unobserve"in e||"revoke"in e)throw new Error('target object MUST NOT have nor own neither inherited properties from the following list: "observe", "unobserve", "revoke"');if(n(e))throw new Error(e+" found to be one of non-observable object types: "+w);var t=new f(e),o=new s(t);return g.set(t,o),t.proxy}}),Reflect.defineProperty(e,"Observable",{value:s})}(this),(()=>{"use strict";function e(e,t,n){function o(t){i.DataTier.views.processChanges(e,t)}let a;Reflect.defineProperty(this,"name",{value:e}),Reflect.defineProperty(this,"data",{get:function(){return a},set:function(t){t&&(r(t),a&&a.revoke());let n=a;(a=t)&&a.observe(o),i.DataTier.views.processChanges(e,[{type:"update",value:a,oldValue:n,path:[]}])}}),c[e]=this,this.data=t}function t(t,n,a){if(o(t),n&&r(n),c[t])throw new Error("existing tie ("+t+") MAY NOT be re-created, use the tie's own APIs to reconfigure it");return new e(t,n,a)}function n(e){e&&c[e]&&(c[e].observable.revoke(),delete c[e])}function o(e){if(!e||"string"!=typeof e)throw new Error("tie name MUST be a non-empty string");if(/\W/.test(e))throw new Error("tie name MUST consist of alphanumerics or underlines ([a-zA-Z0-9_]) ONLY")}function r(e){if(!e||"object"!=typeof e||"function"!=typeof e.observe||"function"!=typeof e.unobserve||"function"!=typeof e.revoke)throw new Error(e+" is not a valid Observable")}function a(e,t,n){let o;if(e){for(o=0;o<t.length-1;o++)e=e[t[o]]||{};e[t[o]]=n}}const i=this||window,c={};e.prototype.viewToDataProcessor=function(e){a(e.data,e.path,e.view.value)};Reflect.defineProperty(i,"DataTier",{value:{}});Reflect.defineProperty(i.DataTier,"ties",{value:{get get(){return function(e){return c[e]}},get create(){return t},get remove(){return n}}})})(),(()=>{"use strict";function e(e,t){Reflect.defineProperty(this,"name",{value:e}),Reflect.defineProperty(this,"dataToView",{value:t.dataToView}),"function"==typeof t.inputToData&&Reflect.defineProperty(this,"inputToData",{value:t.inputToData}),"function"==typeof t.parseParam&&Reflect.defineProperty(this,"parseParam",{value:t.parseParam}),"function"==typeof t.isChangedPathRelevant&&Reflect.defineProperty(this,"isChangedPathRelevant",{value:t.isChangedPathRelevant})}function t(t,n){if("string"!=typeof t||!t)throw new Error("name MUST be a non-empty string");if(i[t])throw new Error('controller "'+t+'" already exists; you may want to reconfigure the existing controller');if("object"!=typeof n||!n)throw new Error("configuration MUST be a non-null object");if("function"!=typeof n.dataToView)throw new Error('configuration MUST have a "dataToView" function defined');i[t]=new e(t,n),a.DataTier.views.applyController(i[t])}function n(e){return i[e]}function o(e){if("string"!=typeof e||!e)throw new Error("controller name MUST be a non-empty string");return delete i[e]}function r(e){let t=[];return e&&e.dataset&&Object.keys(e.dataset).filter(e=>e in i).map(e=>i[e]).forEach(e=>t.push(e)),t}const a=this||window,i={};if(!a.DataTier)throw new Error("DataTier framework was not properly initialized");e.prototype.parseParam=function(e){let t="",n=[];return e&&(t=(n=e.trim().split(".")).shift()),{tieName:t,dataPath:n}};e.prototype.isChangedPathRelevant=function(e,t){return t.startsWith(e)};Reflect.defineProperty(a.DataTier,"controllers",{value:{get get(){return n},get add(){return t},get remove(){return o},get getApplicable(){return r}}})})(),(()=>{"use strict";function e(e,t){let n;if(e){for(n=0;n<t.length;n++)if(!(e=e[t[n]]))return;return e}}function t(e){y.getApplicable(e.target).forEach(t=>{if("tieValue"===t.name){let n=t.parseParam(e.target.dataset[t.name]),o=d.get(n.tieName);if(!n.dataPath)return void console.error("path to data not available");if(!o)return void console.error('tie "'+n.tieName+'" not found');o.viewToDataProcessor({data:o.data,path:n.dataPath,view:e.target})}})}function n(e){"INPUT"!==e.nodeName&&"SELECT"!==e.nodeName||e.addEventListener("change",t)}function o(e){e.removeEventListener("change",t)}function r(e){"IFRAME"===e.nodeName?(p(e.contentDocument),e.addEventListener("load",function(){p(this.contentDocument),i(this.contentDocument)}),i(e.contentDocument)):e.dataset&&Object.keys(e.dataset).forEach(t=>{if(t.startsWith("tie")){let o=y.get(t);if(o){let t,r,i,c=o.parseParam(e.dataset[o.name]),f=c.dataPath.join(".");v[c.tieName]||(v[c.tieName]={}),(t=v[c.tieName])[o.name]||(t[o.name]={}),(r=t[o.name])[f]||(r[f]=[]),(i=r[f]).indexOf(e)<0&&(i.push(e),a(e,o.name),n(e))}else g[t]||(g[t]=[]),g[t].push(e)}})}function a(t,n){let o,r,a,i;r=(o=y.get(n)).parseParam(t.dataset[n]),(a=d.get(r.tieName))&&(i=e(a.data,r.dataPath),o.dataToView(i,t))}function i(e){if(e&&(e.nodeType===Node.DOCUMENT_NODE||e.nodeType===Node.ELEMENT_NODE)){let t;(t="IFRAME"===e.nodeName?Array.from(e.contentDocument.getElementsByTagName("*")):Array.from(e.getElementsByTagName("*"))).push(e),t.forEach(r)}}function c(e){let t,n,r,a;e&&e.getElementsByTagName&&((t=Array.from(e.getElementsByTagName("*"))).push(e),t.forEach(e=>{y.getApplicable(e).forEach(t=>{n=t.parseParam(e.dataset[t.name]);r=v[n.tieName][t.name][n.dataPath.join(".")];a=r.indexOf(e);a>=0&&(r.splice(a,1),o(e))})}))}function f(e,t,n,o){let r,i,c=-1;r=y.get(t).parseParam(n),v[r.tieName]&&v[r.tieName][t]&&((i=v[r.tieName][t][r.dataPath])&&(c=i.indexOf(e)),c>=0&&i.splice(c,1)),r=y.get(t).parseParam(o),v[r.tieName]||(v[r.tieName]={}),v[r.tieName][t]||(v[r.tieName][t]={}),v[r.tieName][t][r.dataPath]||(v[r.tieName][t][r.dataPath]=[]),v[r.tieName][t][r.dataPath].push(e),a(e,t)}function s(e,t){let n,o,r,i=v[e];i&&t.forEach(function(e){r=e.path.join("."),Object.keys(i).forEach(e=>{o=i[e];o&&(n=y.get(e),Object.keys(o).forEach(t=>{n.isChangedPathRelevant(r,t)&&o[t].forEach(t=>{a(t,e)})}))})})}function l(e){g[e.name]&&(g[e.name].forEach(r),delete g[e.name])}function u(e){let t,n=2,o=e.split("-");for(t=o[1];n<o.length;)t+=o[n][0].toUpperCase()+o[n++].substr(1);return t}function p(e){function t(e){e.forEach(e=>{if("attributes"===e.type){let t=e.target,n=e.attributeName;0===n.indexOf("data-tie")?f(t,u(n),e.oldValue,t.getAttribute(n)):"src"===n&&"IFRAME"===t.nodeName&&c(t.contentDocument)}else"childList"===e.type&&(Array.from(e.addedNodes).forEach(e=>{"IFRAME"===e.nodeName?(e.contentDocument&&(p(e.contentDocument),i(e.contentDocument)),e.addEventListener("load",function(){p(this.contentDocument),i(this.contentDocument)})):i(e)}),Array.from(e.removedNodes).forEach(e=>{c("IFRAME"===e.nodeName?e.contentDocument:e)}))})}new MutationObserver(t).observe(e,{childList:!0,attributes:!0,characterData:!1,subtree:!0,attributeOldValue:!0,characterDataOldValue:!1})}const h=this||window;if(!h.DataTier)throw new Error("DataTier framework was not properly initialized");const d=h.DataTier.ties,y=h.DataTier.controllers,v={},g={};Reflect.defineProperty(h.DataTier,"views",{value:{get processChanges(){return s},get applyController(){return l}}});p(document);i(document)})(),(()=>{"use strict";const e=this||window,t=e.DataTier.controllers.add;if(!e.DataTier)throw new Error("DataTier framework was not properly initialized");t("tieValue",{dataToView:function(e,t){"checkbox"===t.type?t.checked=e:t.value=e||""}});t("tieText",{dataToView:function(e,t){t.textContent=e||""}});t("tiePlaceholder",{dataToView:function(e,t){t.placeholder=e||""}});t("tieTooltip",{dataToView:function(e,t){t.title=e||""}});t("tieSrc",{dataToView:function(e,t){t.src=e||""}});t("tieHRef",{dataToView:function(e,t){t.href=e||""}});t("tieDateValue",{dataToView:function(e,t){t.value=e?e.toLocaleString():""}});t("tieDateText",{dataToView:function(e,t){t.textContent=e?e.toLocaleString():""}});t("tieClasses",{isChangedPathRelevant:function(e,t){let n=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===n.length||2===n.length&&""===n[0]},dataToView:function(e,t){e&&"object"==typeof e&&Object.keys(e).forEach(function(n){e[n]?t.classList.add(n):t.classList.remove(n)})}});t("tieList",{parseParam:function(e){return this.constructor.prototype.parseParam(e.split(/\s*=>\s*/)[0])},isChangedPathRelevant:function(e,t){let n=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===n.length||2===n.length&&""===n[0]},dataToView:function(e,t){let n,o,r,a,i,c,f,s=t.parentNode;if("TEMPLATE"!==t.nodeName)throw new Error("tieList may be defined on template elements only");if(t.dataset.listSourceAid||(t.dataset.listSourceAid=(new Date).getTime()),n=function(e,t){let n=Array.from(s.querySelectorAll('[data-list-item-aid="'+t+'"]'));for(;n.length>e;)s.removeChild(n.pop());return n.length}(e?e.length:0,t.dataset.listSourceAid),e&&n<e.length)if((r=t.dataset.tieList.trim().split(/\s+/))&&3===r.length&&"=>"===r[1]){for(a=r[2],c=(i=t.ownerDocument).createDocumentFragment();n<e.length;n++){for(o=i.importNode(t.content,!0),Array.from(o.querySelectorAll("*")).forEach(e=>{Object.keys(e.dataset).forEach(t=>{let o=e.dataset[t];o.startsWith(a)&&(e.dataset[t]=o.replace(a,r[0]+"."+n))})}),c.appendChild(o),f=c.lastChild;f.nodeType!==Node.ELEMENT_NODE&&null!==f.previousSibling;)f=f.previousSibling;f.dataset.listItemAid=t.dataset.listSourceAid}s.appendChild(c)}else console.error('invalid parameter for "tieList" rule specified')}})})();