!function(e){"use strict";function t(e){return p.indexOf(e.constructor.name)>=0}function r(e,r,o){var a,c=e.hasOwnProperty(r),p=e[r],h=l.get(e),d=u.get(h.root);if((a=o&&"object"==typeof o&&!t(o)?Reflect.set(e,r,new n(o,r,h).proxy):Reflect.set(e,r,o))&&(s.has(p)&&(l.get(s.get(p)).revoke(),s.delete(p)),d.hasListeners)){var y=h.path.concat(r),v=[];v.push(c?new f(y,o,p):new i(y,o)),h.preventCallbacks||d.notify(v)}return a}function o(e,t){var r,o=e[t],n=l.get(e),a=u.get(n.root);if((r=Reflect.deleteProperty(e,t))&&(s.has(o)&&(l.get(s.get(o)).revoke(),s.delete(o)),a.hasListeners)){var i=n.path.concat(t),f=[];f.push(new c(i,o)),n.preventCallbacks||a.notify(f)}return r}function n(e,a,p){var h,d;if(!e||"object"!=typeof e)throw new Error("Observed MUST be created from a non null object origin");if(p&&(void 0===a||null===a))throw new Error("any non-root (parent-less) Observed MUST have an own path; now parent is "+p+"; key is "+a);if(p&&!(p instanceof n))throw new Error("parent, when supplied, MUST be an instance of Observed");h=function(e){return Array.isArray(e)?e.slice():Object.assign(new e.constructor,e)}(e),Array.isArray(h)?(!function(e,r){e.forEach(function(o,a){o&&"object"==typeof o&&!t(o)&&(e[a]=new n(o,a,r).proxy)})}(h,this),d=Proxy.revocable(h,{set:r,get:function(e,t){var r=l.get(e),o=u.get(r.root);return"pop"===t?function(){var n,a,i;return n=e.length-1,(a=Reflect.apply(e[t],e,arguments))&&"object"==typeof a&&(a=s.get(a),l.get(a).revoke()),i=[new c(r.path.concat(n),a)],o.notify(i),a}:"push"===t?function(){var a,f,c,s=[];return a=Array.from(arguments),c=e.length,a.forEach(function(e,t){e&&"object"==typeof e&&(a[t]=new n(e,c+t,r).proxy),s.push(new i(r.path.concat(c+t),e))}),f=Reflect.apply(e[t],e,a),o.notify(s),f}:"shift"===t?function(){var n,a,i;return(n=Reflect.apply(e[t],e,arguments))&&"object"==typeof n&&(n=s.get(n),l.get(n).revoke()),e.forEach(function(e,t){e&&"object"==typeof e&&((i=l.get(s.get(e)))?i.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),a=[new c(r.path.concat(0),n)],o.notify(a),n}:"unshift"===t?function(){var a,f,c,u=[];(a=Array.from(arguments)).forEach(function(e,t){e&&"object"==typeof e&&(a[t]=new n(e,t,r).proxy)}),f=Reflect.apply(e[t],e,a),e.forEach(function(e,t){e&&"object"==typeof e&&((c=l.get(s.get(e)))?c.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))});for(var p=0;p<a.length;p++)u.push(new i(r.path.concat(p),e[p]));return o.notify(u),f}:"reverse"===t?function(){var r,n=[];return Reflect.apply(e[t],e,arguments),e.forEach(function(e,t){e&&"object"==typeof e&&((r=l.get(s.get(e)))?r.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),n.push(new function(){Reflect.defineProperty(this,"type",{value:"reverse"})}),o.notify(n),this}:"sort"===t?function(){var r,n=[];return Reflect.apply(e[t],e,arguments),e.forEach(function(e,t){e&&"object"==typeof e&&((r=l.get(s.get(e)))?r.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),n.push(new function(){Reflect.defineProperty(this,"type",{value:"shuffle"})}),o.notify(n),this}:"fill"===t?function(){var a,c,u,p=[];a=arguments.length<2?0:arguments[1]<0?e.length+arguments[1]:arguments[1],c=arguments.length<3?e.length:arguments[2]<0?e.length+arguments[2]:arguments[2],u=e.slice(),Reflect.apply(e[t],e,arguments);for(var h=a;h<c;h++)e[h]&&"object"==typeof e[h]&&(e[h]=new n(e[h],h,r).proxy),u.hasOwnProperty(h)?(p.push(new f(r.path.concat(h),e[h],u[h]&&"object"==typeof u[h]?s.get(u[h]):u[h])),u[h]&&"object"==typeof u[h]&&l.get(s.get(u[h])).revoke()):p.push(new i(r.path.concat(h),e[h]));return o.notify(p),this}:"splice"===t?function(){var a,u,p,h,d,y,v,g=[];for((a=Array.from(arguments)).forEach(function(e,t){t>1&&e&&"object"==typeof e&&(a[t]=new n(e,t,r).proxy)}),d=0===a.length?0:a[0]<0?e.length+a[0]:a[0],y=a.length<2?e.length-d:a[1],v=Math.max(a.length-2,0),u=Reflect.apply(e[t],e,a),e.forEach(function(e,t){e&&"object"==typeof e&&((p=l.get(s.get(e)))?p.ownKey=t:console.error("failed to resolve proxy -> target -> observed"))}),u.forEach(function(e,t){e&&"object"==typeof e&&(u[t]=s.get(e),l.get(u[t]).revoke())}),h=0;h<y;h++)h<v?g.push(new f(r.path.concat(d+h),e[d+h],u[h])):g.push(new c(r.path.concat(d+h),u[h]));for(;h<v;h++)g.push(new i(r.path.concat(d+h),e[d+h]));return o.notify(g),u}:Reflect.get(e,t)},deleteProperty:o})):(!function(e,r){Reflect.ownKeys(e).forEach(function(o){e[o]&&"object"==typeof e[o]&&!t(e[o])&&(e[o]=new n(e[o],o,r).proxy)})}(h,this),d=Proxy.revocable(h,{set:r,deleteProperty:o})),l.set(h,this),s.set(d.proxy,h),Reflect.defineProperty(this,"revokable",{value:d}),Reflect.defineProperty(this,"proxy",{value:d.proxy}),Reflect.defineProperty(this,"parent",{value:p}),Reflect.defineProperty(this,"ownKey",{value:a,writable:!0})}function a(e){var t=!1,r=[];Reflect.defineProperty(e.proxy,"observe",{value:function(e){if(t)throw new TypeError("revoked Observable MAY NOT be observed anymore");if("function"!=typeof e)throw new Error("observer (callback) parameter MUST be a function");r.indexOf(e)<0?r.push(e):console.info("observer (callback) may be bound to an observable only once")}}),Reflect.defineProperty(e.proxy,"unobserve",{value:function(){if(t)throw new TypeError("revoked Observable MAY NOT be unobserved amymore");arguments.length?Array.from(arguments).forEach(function(e){var t=r.indexOf(e);t>=0&&r.splice(t,1)}):r.splice(0,r.length)}}),Reflect.defineProperty(e.proxy,"revoke",{value:function(){t?console.log("revokation of Observable have an effect only once"):(t=!0,e.revoke())}}),Reflect.defineProperty(this,"hasListeners",{get:function(){return r.length>0}}),Reflect.defineProperty(this,"notify",{value:function(e){r.forEach(function(t){try{t(e)}catch(e){console.error(e)}})}})}function i(e,t){Reflect.defineProperty(this,"type",{value:"insert"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"value",{value:t})}function f(e,t,r){Reflect.defineProperty(this,"type",{value:"update"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"value",{value:t}),Reflect.defineProperty(this,"oldValue",{value:r})}function c(e,t){Reflect.defineProperty(this,"type",{value:"delete"}),Reflect.defineProperty(this,"path",{value:e}),Reflect.defineProperty(this,"oldValue",{value:t})}var s=new Map,l=new Map,u=new Map,p=["Date","Blob","Number","String","Boolean","Error","SyntaxError","TypeError","URIError","Function","Promise","RegExp"];Reflect.defineProperty(n.prototype,"root",{get:function(){for(var e=this;e.parent;)e=e.parent;return e}}),Reflect.defineProperty(n.prototype,"path",{get:function(){for(var e=[],t=this;void 0!==t.ownKey;)e.push(t.ownKey),t=t.parent;return e.reverse()}}),Reflect.defineProperty(n.prototype,"revoke",{value:function(){var e=this.proxy;Reflect.ownKeys(e).forEach(function(t){var r=e[t];s.has(r)&&(l.get(s.get(r)).revoke(),s.get(e)[t]=s.get(r))}),this.revokable.revoke()}}),Reflect.defineProperty(a,"from",{value:function(e){if(!e||"object"!=typeof e)throw new Error("observable MAY ONLY be created from non-null object only");if("observe"in e||"unobserve"in e||"revoke"in e)throw new Error('target object MUST NOT have nor own neither inherited properties from the following list: "observe", "unobserve", "revoke"');if(t(e))throw new Error(e+" found to be one of non-observable object types: "+p);var r=new n(e),o=new a(r);return u.set(r,o),r.proxy}}),Reflect.defineProperty(e,"Observable",{value:a})}(this),(()=>{"use strict";function e(e,n,a){let i;Reflect.defineProperty(this,"name",{value:e}),Reflect.defineProperty(this,"data",{get:function(){return i},set:function(o){let n=i,a=t(o);i&&i.revoke(),(i=a)&&i.observe(function(t){r.DataTier.views.processChanges(e,t)}),r.DataTier.views.processChanges(e,[{type:"update",value:i,oldValue:n,path:[]}])}}),o[e]=this,this.data=n}function t(e){if(void 0===e||null===e)return e;if("object"!=typeof e)throw new Error(e+" is not of type Observable and not an object");if("function"==typeof e.observe&&"function"==typeof e.unobserve&&"function"==typeof e.revoke)return e;if(r.Observable){if("function"==typeof e.observe||"function"==typeof e.unobserve||"function"==typeof e.revoke)throw new Error(e+" is not of type Observable and can not be transformed into Observable (some of its functions already implemented?)");return r.Observable.from(e)}throw new Error(e+" is not of type Observable and no embedded Observable implementation found")}const r=this||window,o={};e.prototype.viewToDataProcessor=function(e){!function(e,t,r){let o;if(e){for(o=0;o<t.length-1;o++)e=t[o]in e?e[t[o]]:{};e[t[o]]=r}}(e.data,e.path,e.view.value)},Reflect.defineProperty(r,"DataTier",{value:{}}),Reflect.defineProperty(r.DataTier,"ties",{value:{get get(){return function(e){return o[e]}},get create(){return function(r,n,a){if(function(e){if(!e||"string"!=typeof e)throw new Error("tie name MUST be a non-empty string");if(/\W/.test(e))throw new Error("tie name MUST consist of alphanumerics or underlines ([a-zA-Z0-9_]) ONLY")}(r),o[r])throw new Error("existing tie ("+r+") MAY NOT be re-created, use the tie's own APIs to reconfigure it");return new e(r,t(n),a)}},get remove(){return function(e){e&&o[e]&&(o[e].observable.revoke(),delete o[e])}}}})})(),(()=>{"use strict";function e(e,t){Reflect.defineProperty(this,"name",{value:e}),Reflect.defineProperty(this,"toView",{value:t.toView}),"function"==typeof t.toData&&Reflect.defineProperty(this,"toData",{value:t.toData}),"function"==typeof t.parseParam&&Reflect.defineProperty(this,"parseParam",{value:t.parseParam}),"function"==typeof t.isChangedPathRelevant&&Reflect.defineProperty(this,"isChangedPathRelevant",{value:t.isChangedPathRelevant})}const t=this||window,r={};if(!t.DataTier)throw new Error("DataTier framework was not properly initialized");e.prototype.parseParam=function(e){let t="",r=[];return e&&(t=(r=e.trim().split(".")).shift()),{tieName:t,dataPath:r}},e.prototype.isChangedPathRelevant=function(e,t){return t.startsWith(e)},Reflect.defineProperty(t.DataTier,"processors",{value:{get get(){return function(e){return r[e]}},get add(){return function(o,n){if("string"!=typeof o||!o)throw new Error("name MUST be a non-empty string");if(r[o])throw new Error('data processor "'+o+'" already exists; you may want to reconfigure the existing one');if("object"!=typeof n||!n)throw new Error("configuration MUST be a non-null object");if("function"!=typeof n.toView)throw new Error('configuration MUST have a "toView" function defined');r[o]=new e(o,n),t.DataTier.views.applyProcessor(r[o])}},get remove(){return function(e){if("string"!=typeof e||!e)throw new Error("controller name MUST be a non-empty string");return delete r[e]}},get getApplicable(){return function(e){let t=[];return e&&e.dataset&&Object.keys(e.dataset).filter(e=>e in r).map(e=>r[e]).forEach(t.push),t}}}})})(),(()=>{"use strict";function e(e){c.getApplicable(e.target).forEach(t=>{if("tieValue"===t.name){let r=t.parseParam(e.target.dataset[t.name]),o=f.get(r.tieName);if(!r.dataPath)return void console.error("path to data not available");if(!o)return void console.error('tie "'+r.tieName+'" not found');o.viewToDataProcessor({data:o.data,path:r.dataPath,view:e.target})}})}function t(t){"IFRAME"===t.nodeName?(a(t.contentDocument),t.addEventListener("load",function(){a(this.contentDocument),o(this.contentDocument)}),o(t.contentDocument)):t.dataset&&Object.keys(t.dataset).forEach(o=>{if(o.startsWith("tie")){let n=c.get(o);if(n){let o,a,i,f=n.parseParam(t.dataset[n.name]),c=f.dataPath.join(".");s[f.tieName]||(s[f.tieName]={}),(o=s[f.tieName])[n.name]||(o[n.name]={}),(a=o[n.name])[c]||(a[c]=[]),(i=a[c]).indexOf(t)<0&&(i.push(t),r(t,n.name),function(t){"INPUT"!==t.nodeName&&"SELECT"!==t.nodeName||t.addEventListener("change",e)}(t))}else l[o]||(l[o]=[]),l[o].push(t)}})}function r(e,t){let r,o,n,a;o=(r=c.get(t)).parseParam(e.dataset[t]),(n=f.get(o.tieName))&&(a=function(e,t){let r;if(e){for(r=0;r<t.length;r++){if(!(t[r]in e))return;e=e[t[r]]}return e}}(n.data,o.dataPath),r.toView(a,e))}function o(e){if(e&&(e.nodeType===Node.DOCUMENT_NODE||e.nodeType===Node.ELEMENT_NODE)){let r;(r="IFRAME"===e.nodeName?Array.from(e.contentDocument.getElementsByTagName("*")):Array.from(e.getElementsByTagName("*"))).push(e),r.forEach(t)}}function n(t){let r,o,n,a;t&&t.getElementsByTagName&&((r=Array.from(t.getElementsByTagName("*"))).push(t),r.forEach(t=>{c.getApplicable(t).forEach(r=>{o=r.parseParam(t.dataset[r.name]),n=s[o.tieName][r.name][o.dataPath.join(".")],(a=n.indexOf(t))>=0&&(n.splice(a,1),function(t){t.removeEventListener("change",e)}(t))})}))}function a(e){new MutationObserver(function(e){e.forEach(e=>{if("attributes"===e.type){let t=e.target,o=e.attributeName;0===o.indexOf("data-tie")?function(e,t,o,n){let a,i,f=-1;a=c.get(t).parseParam(o),s[a.tieName]&&s[a.tieName][t]&&((i=s[a.tieName][t][a.dataPath])&&(f=i.indexOf(e)),f>=0&&i.splice(f,1)),a=c.get(t).parseParam(n),s[a.tieName]||(s[a.tieName]={}),s[a.tieName][t]||(s[a.tieName][t]={}),s[a.tieName][t][a.dataPath]||(s[a.tieName][t][a.dataPath]=[]),s[a.tieName][t][a.dataPath].push(e),r(e,t)}(t,function(e){let t,r=2,n=o.split("-");for(t=n[1];r<n.length;)t+=n[r][0].toUpperCase()+n[r++].substr(1);return t}(),e.oldValue,t.getAttribute(o)):"src"===o&&"IFRAME"===t.nodeName&&n(t.contentDocument)}else"childList"===e.type&&(Array.from(e.addedNodes).forEach(e=>{"IFRAME"===e.nodeName?(e.contentDocument&&(a(e.contentDocument),o(e.contentDocument)),e.addEventListener("load",function(){a(this.contentDocument),o(this.contentDocument)})):o(e)}),Array.from(e.removedNodes).forEach(e=>{n("IFRAME"===e.nodeName?e.contentDocument:e)}))})}).observe(e,{childList:!0,attributes:!0,characterData:!1,subtree:!0,attributeOldValue:!0,characterDataOldValue:!1})}const i=this||window;if(!i.DataTier)throw new Error("DataTier framework was not properly initialized");const f=i.DataTier.ties,c=i.DataTier.processors,s={},l={};Reflect.defineProperty(i.DataTier,"views",{value:{get processChanges(){return function(e,t){let o,n,a,i=s[e];i&&t.forEach(e=>{a=e.path.join("."),Object.keys(i).forEach(e=>{(n=i[e])&&(o=c.get(e),Object.keys(n).forEach(t=>{o.isChangedPathRelevant(a,t)&&n[t].forEach(t=>{r(t,e)})}))})})}},get applyProcessor(){return function(e){l[e.name]&&(l[e.name].forEach(t),delete l[e.name])}}}}),a(document),o(document)})(),(()=>{"use strict";const e=this||window,t=e.DataTier.processors.add;if(!e.DataTier)throw new Error("DataTier framework was not properly initialized");t("tieValue",{toView:function(e,t){"checkbox"===t.type?t.checked=e:t.value=void 0!==e&&null!==e?e:""}}),t("tieText",{toView:function(e,t){t.textContent=void 0!==e&&null!==e?e:""}}),t("tiePlaceholder",{toView:function(e,t){t.placeholder=void 0!==e&&null!==e?e:""}}),t("tieTooltip",{toView:function(e,t){t.title=void 0!==e&&null!==e?e:""}}),t("tieSrc",{toView:function(e,t){t.src=void 0!==e&&null!==e?e:""}}),t("tieHRef",{toView:function(e,t){t.href=void 0!==e&&null!==e?e:""}}),t("tieDateValue",{toView:function(e,t){t.value=void 0!==e&&null!==e?e.toLocaleString():""}}),t("tieDateText",{toView:function(e,t){t.textContent=void 0!==e&&null!==e?e.toLocaleString():""}}),t("tieClasses",{isChangedPathRelevant:function(e,t){let r=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===r.length||2===r.length&&""===r[0]},toView:function(e,t){e&&"object"==typeof e&&Object.keys(e).forEach(function(r){e[r]?t.classList.add(r):t.classList.remove(r)})}}),t("tieList",{parseParam:function(e){return this.constructor.prototype.parseParam(e.split(/\s*=>\s*/)[0])},isChangedPathRelevant:function(e,t){let r=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===r.length||2===r.length&&""===r[0]},toView:function(e,t){let r,o,n,a,i,f,c,s=t.parentNode;if("TEMPLATE"!==t.nodeName)throw new Error("tieList may be defined on template elements only");if(t.dataset.listSourceAid||(t.dataset.listSourceAid=(new Date).getTime()),r=function(e,t){let r=Array.from(s.querySelectorAll('[data-list-item-aid="'+t+'"]'));for(;r.length>e;)s.removeChild(r.pop());return r.length}(e?e.length:0,t.dataset.listSourceAid),e&&r<e.length)if((n=t.dataset.tieList.trim().split(/\s+/))&&3===n.length&&"=>"===n[1]){for(a=n[2],f=(i=t.ownerDocument).createDocumentFragment();r<e.length;r++){for(o=i.importNode(t.content,!0),Array.from(o.querySelectorAll("*")).forEach(e=>{Object.keys(e.dataset).forEach(t=>{let o=e.dataset[t];o.startsWith(a)&&(e.dataset[t]=o.replace(a,n[0]+"."+r))})}),f.appendChild(o),c=f.lastChild;c.nodeType!==Node.ELEMENT_NODE&&null!==c.previousSibling;)c=c.previousSibling;c.dataset.listItemAid=t.dataset.listSourceAid}s.appendChild(f)}else console.error('invalid parameter for "tieList" rule specified')}})})();