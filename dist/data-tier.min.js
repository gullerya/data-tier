(()=>{"use strict";function e(e){return h.indexOf(e.constructor.name)>=0}function t(e,t){let n,o=u.get(e),a=p.get(o.root);return n="pop"===t?function(){let n,r,i;return n=e.length-1,(r=Reflect.apply(e[t],e,arguments))&&"object"==typeof r&&(r=c.get(r),u.get(r).revoke()),i=[new s(o.path.concat(n),r)],a.notify(i),r}:"push"===t?function(){let n,l,s,f=[];n=Array.from(arguments),s=e.length;for(let e,t=0,a=n.length;t<a;t++)(e=n[t])&&"object"==typeof e&&(n[t]=new r(e,s+t,o).proxy),f.push(new i(o.path.concat(s+t),e));return l=Reflect.apply(e[t],e,n),a.notify(f),l}:"shift"===t?function(){let n,r,i;(n=Reflect.apply(e[t],e,arguments))&&"object"==typeof n&&(n=c.get(n),u.get(n).revoke());for(let t,n=0,o=e.length;n<o;n++)(t=e[n])&&"object"==typeof t&&((i=u.get(c.get(t)))?i.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));return r=[new s(o.path.concat(0),n)],a.notify(r),n}:"unshift"===t?function(){let n,l,s,f=[];(n=Array.from(arguments)).forEach(function(e,t){e&&"object"==typeof e&&(n[t]=new r(e,t,o).proxy)}),l=Reflect.apply(e[t],e,n);for(let t,n=0,o=e.length;n<o;n++)(t=e[n])&&"object"==typeof t&&((s=u.get(c.get(t)))?s.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));for(let t=0,r=n.length;t<r;t++)f.push(new i(o.path.concat(t),e[t]));return a.notify(f),l}:"reverse"===t?function(){let n,o;Reflect.apply(e[t],e,arguments);for(let t,n=0,r=e.length;n<r;n++)(t=e[n])&&"object"==typeof t&&((o=u.get(c.get(t)))?o.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));return n=[new function(){Object.defineProperties(this,{type:{value:"reverse"}})}],a.notify(n),this}:"sort"===t?function(){let n,o;Reflect.apply(e[t],e,arguments);for(let t,n=0,r=e.length;n<r;n++)(t=e[n])&&"object"==typeof t&&((o=u.get(c.get(t)))?o.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));return n=[new function(){Object.defineProperties(this,{type:{value:"shuffle"}})}],a.notify(n),this}:"fill"===t?function(){let n,s,f,p=[],h=arguments.length,d=e.length;n=h<2?0:arguments[1]<0?d+arguments[1]:arguments[1],s=h<3?d:arguments[2]<0?d+arguments[2]:arguments[2],f=e.slice(),Reflect.apply(e[t],e,arguments);for(let t,a=n;a<s;a++)(t=e[a])&&"object"==typeof t&&(e[a]=new r(t,a,o).proxy),f.hasOwnProperty(a)?(p.push(new l(o.path.concat(a),e[a],f[a]&&"object"==typeof f[a]?c.get(f[a]):f[a])),f[a]&&"object"==typeof f[a]&&u.get(c.get(f[a])).revoke()):p.push(new i(o.path.concat(a),e[a]));return a.notify(p),this}:"splice"===t?function(){let n,f,p,h,d,y,g,v,b=[],w=e.length;v=(n=Array.from(arguments)).length;for(let e,t=0;t<v;t++)e=n[t],t>1&&e&&"object"==typeof e&&(n[t]=new r(e,t,o).proxy);d=0===v?0:n[0]<0?w+n[0]:n[0],y=v<2?w-d:n[1],g=Math.max(v-2,0),f=Reflect.apply(e[t],e,n);for(let t,n=0;n<w;n++)(t=e[n])&&"object"==typeof t&&((p=u.get(c.get(t)))?p.ownKey=n:console.error("failed to resolve proxy -> target -> observed"));for(let e,t=0,n=f.length;t<n;t++)e=f[t],y&&"object"==typeof y&&(e=c.get(y),u.get(e).revoke());for(h=0;h<y;h++)h<g?b.push(new l(o.path.concat(d+h),e[d+h],f[h])):b.push(new s(o.path.concat(d+h),f[h]));for(;h<g;h++)b.push(new i(o.path.concat(d+h),e[d+h]));return a.notify(b),f}:Reflect.get(e,t)}function n(t,n,o){let a,s=t.hasOwnProperty(n),f=t[n],h=u.get(t),d=p.get(h.root);if((a=o&&"object"==typeof o&&!e(o)?Reflect.set(t,n,new r(o,n,h).proxy):Reflect.set(t,n,o))&&(c.has(f)&&(u.get(c.get(f)).revoke(),c.delete(f)),d.hasListeners)){let e=h.path.concat(n),t=[s?new l(e,o,f):new i(e,o)];h.preventCallbacks||d.notify(t)}return a}function o(e,t){let n,o=e[t],r=u.get(e),a=p.get(r.root);if((n=Reflect.deleteProperty(e,t))&&(c.has(o)&&(u.get(c.get(o)).revoke(),c.delete(o)),a.hasListeners)){let e=[new s(r.path.concat(t),o)];r.preventCallbacks||a.notify(e)}return n}function r(a,i,l){let s,f;if(!a||"object"!=typeof a)throw new Error("Observed MUST be created from a non null object origin");if(l&&(void 0===i||null===i))throw new Error("any non-root (parent-less) Observed MUST have an own path; now parent is "+l+"; key is "+i);if(l&&!(l instanceof r))throw new Error("parent, when supplied, MUST be an instance of Observed");s=function(e){return Array.isArray(e)?e.slice():Object.assign(new e.constructor,e)}(a),Array.isArray(s)?(!function(t,n){for(let o,a=0,i=t.length;a<i;a++)(o=t[a])&&"object"==typeof o&&!e(o)&&(t[a]=new r(o,a,n).proxy)}(s,this),f=Proxy.revocable(s,{set:n,get:t,deleteProperty:o})):(!function(t,n){let o=Object.keys(t);for(let a,i,l=0,s=o.length;l<s;l++)(i=t[a=o[l]])&&"object"==typeof i&&!e(i)&&(t[a]=new r(i,a,n).proxy)}(s,this),f=Proxy.revocable(s,{set:n,deleteProperty:o})),u.set(s,this),c.set(f.proxy,s),Object.defineProperties(this,{revokable:{value:f},proxy:{value:f.proxy},parent:{value:l},ownKey:{value:i,writable:!0}})}function a(e){let t=!1,n=[];Object.defineProperties(e.proxy,{observe:{value:function(e){if(t)throw new TypeError("revoked Observable MAY NOT be observed anymore");if("function"!=typeof e)throw new Error("observer (callback) parameter MUST be a function");n.indexOf(e)<0?n.push(e):console.info("observer (callback) may be bound to an observable only once")}},unobserve:{value:function(){if(t)throw new TypeError("revoked Observable MAY NOT be unobserved amymore");if(arguments.length)for(let e,t=0,o=arguments.length;t<o;t++)(e=n.indexOf(arguments[t]))>=0&&n.splice(e,1);else n.splice(0,n.length)}},revoke:{value:function(){t?console.log("revokation of Observable have an effect only once"):(t=!0,e.revoke())}}}),Object.defineProperties(this,{hasListeners:{value:function(){return n.length>0}},notify:{value:function(e){for(let t,o=0,r=n.length;o<r;o++){t=n[o];try{t(e)}catch(e){console.error(e)}}}}})}function i(e,t){Object.defineProperties(this,{type:{value:"insert"},path:{value:e},value:{value:t}})}function l(e,t,n){Object.defineProperties(this,{type:{value:"update"},path:{value:e},value:{value:t},oldValue:{value:n}})}function s(e,t){Object.defineProperties(this,{type:{value:"delete"},path:{value:e},oldValue:{value:t}})}const f=this||window,c=new Map,u=new Map,p=new Map,h=["Date","Blob","Number","String","Boolean","Error","SyntaxError","TypeError","URIError","Function","Promise","RegExp"];Object.defineProperty(r.prototype,"root",{get:function(){let e=this;for(;e.parent;)e=e.parent;return e}}),Object.defineProperty(r.prototype,"path",{get:function(){let e=[],t=this;for(;void 0!==t.ownKey;)e.push(t.ownKey),t=t.parent;return e.reverse()}}),Object.defineProperty(r.prototype,"revoke",{value:function(){let e=this.proxy,t=Object.keys(e);for(let n,o,r=0,a=t.length;r<a;r++)o=e[n=t[r]],c.has(o)&&(u.get(c.get(o)).revoke(),c.get(e)[n]=c.get(o));this.revokable.revoke()}}),Object.defineProperty(a,"from",{value:function(t){if(!t||"object"!=typeof t)throw new Error("observable MAY ONLY be created from non-null object only");if("observe"in t||"unobserve"in t||"revoke"in t)throw new Error('target object MUST NOT have nor own neither inherited properties from the following list: "observe", "unobserve", "revoke"');if(e(t))throw new Error(t+" found to be one of non-observable object types: "+h);let n=new r(t),o=new a(n);return p.set(n,o),n.proxy}}),Object.defineProperty(f,"Observable",{value:a})})(),(()=>{"use strict";function e(e){return a[e]}function t(e,t,n){if(function(e){if(!e||"string"!=typeof e)throw new Error("tie name MUST be a non-empty string");if(/\W/.test(e))throw new Error("tie name MUST consist of alphanumerics or underlines ([a-zA-Z0-9_]) ONLY")}(e),a[e])throw new Error("existing tie ("+e+") MAY NOT be re-created, use the tie's own APIs to reconfigure it");return new function(e,t,n){function i(t){r.DataTier.views.processChanges(e,t)}let l;Reflect.defineProperty(this,"name",{value:e}),Reflect.defineProperty(this,"data",{get:function(){return l},set:function(t){let n=l,a=o(t);l&&l.revoke(),(l=a)&&l.observe(i),r.DataTier.views.processChanges(e,[{type:"update",value:l,oldValue:n,path:[]}])}}),a[e]=this,this.data=t,Object.seal(this)}(e,o(t),n)}function n(e){e&&a[e]&&(a[e].observable.revoke(),delete a[e])}function o(e){if(void 0===e||null===e)return e;if("object"!=typeof e)throw new Error(e+" is not of type Observable and not an object");if("function"==typeof e.observe&&"function"==typeof e.unobserve&&"function"==typeof e.revoke)return e;if(r.Observable){if("function"==typeof e.observe||"function"==typeof e.unobserve||"function"==typeof e.revoke)throw new Error(e+" is not of type Observable and can not be transformed into Observable (some of its functions already implemented?)");return r.Observable.from(e)}throw new Error(e+" is not of type Observable and no embedded Observable implementation found")}(()=>{let e=window,t=Symbol.for("data-tier");for(;e.parent!==e;)e=e.parent;if(e[t])throw new Error("data-tier found to already being running within this application, cancelling current execution");e[t]=!0})();const r=this||window,a={};Reflect.defineProperty(r,"DataTier",{value:{}}),Reflect.defineProperty(r.DataTier,"ties",{value:{get get(){return e},get create(){return t},get remove(){return n}}})})(),(()=>{"use strict";function e(e,o){Reflect.defineProperty(this,"name",{value:e}),Reflect.defineProperty(this,"toView",{value:o.toView}),Reflect.defineProperty(this,"toData",{value:"function"==typeof o.toData?o.toData:function(e){!function(e,t,n){let o;if(!e)return;for(o=0;o<t.length-1;o++)e=e[t[o]]&&"object"==typeof e[t[o]]?e[t[o]]:e[t[o]]={};e[t[o]]=n}(e.data,e.path,e.view.value)}}),Reflect.defineProperty(this,"changeDOMEventType",{value:"string"==typeof o.changeDOMEventType?o.changeDOMEventType:null}),Reflect.defineProperty(this,"parseParam",{value:"function"==typeof o.parseParam?o.parseParam:t}),Reflect.defineProperty(this,"isChangedPathRelevant",{value:"function"==typeof o.isChangedPathRelevant?o.isChangedPathRelevant:n})}function t(e){let t="",n=[];return e&&(t=(n=e.trim().split(".")).shift()),{tieName:t,dataPath:n}}function n(e,t){return t.startsWith(e)}function o(t,n){if("string"!=typeof t||!t)throw new Error("name MUST be a non-empty string");if(s[t])throw new Error('data processor "'+t+'" already exists; you may want to reconfigure the existing one');if("object"!=typeof n||!n)throw new Error("configuration MUST be a non-null object");if("function"!=typeof n.toView)throw new Error('configuration MUST have a "toView" function defined');s[t]=new e(t,n),l.DataTier.views.applyProcessor(s[t])}function r(e){return s[e]}function a(e){if("string"!=typeof e||!e)throw new Error("controller name MUST be a non-empty string");return delete s[e]}function i(e){let t=[];return e&&e.dataset&&Object.keys(e.dataset).filter(e=>e in s).map(e=>s[e]).forEach(e=>t.push(e)),t}const l=this||window,s={};if(!l.DataTier)throw new Error("data-tier framework was not properly initialized");Reflect.defineProperty(e.prototype,"parseParam",{value:t}),Reflect.defineProperty(e.prototype,"isChangedPathRelevant",{value:n}),Reflect.defineProperty(l.DataTier,"processors",{value:{get get(){return r},get add(){return o},get remove(){return a},get getApplicable(){return i}}})})(),(()=>{"use strict";function e(e){let t,n,o,r=e.target,a=d.getApplicable(r);for(let i=0,l=a.length;i<l;i++)if(t=a[i],e.type===t.changeDOMEventType){if(n=t.parseParam(r.dataset[t.name]),o=h.get(n.tieName),!n.dataPath)return void console.error("path to data not available");if(!o)return void console.error('tie "'+n.tieName+'" not found');t.toData({data:o.data,path:n.dataPath,view:r})}}function t(t,n){t.addEventListener(n,e)}function n(t,n){t.removeEventListener(n,e)}function o(e){if("IFRAME"===e.nodeName)u(e.contentDocument),e.addEventListener("load",function(){u(this.contentDocument),a(this.contentDocument)}),a(e.contentDocument);else if(e.dataset){let n,o,a,i,l,s,f,c=Object.keys(e.dataset);let u=0;for(c.length;n=c[u];u++)n.startsWith("tie")&&((o=d.get(n))?(i=(a=o.parseParam(e.dataset[o.name])).dataPath.join("."),(f=(s=(l=y[a.tieName]||(y[a.tieName]={}))[o.name]||(l[o.name]={}))[i]||(s[i]=[])).indexOf(e)<0&&(f.push(e),r(e,o.name),o.changeDOMEventType&&t(e,o.changeDOMEventType))):(g[n]||(g[n]=[]),g[n].push(e)))}}function r(e,t){let n,o,r,a;o=(n=d.get(t)).parseParam(e.dataset[t]),(r=h.get(o.tieName))&&(a=function(e,t){if(e){for(let n=0,o=t.length;n<o;n++){if(!(t[n]in e))return;e=e[t[n]]}return e}}(r.data,o.dataPath),n.toView(a,e))}function a(e){if(e&&(e.nodeType===Node.DOCUMENT_NODE||e.nodeType===Node.ELEMENT_NODE)){let t;t="IFRAME"===e.nodeName?e.contentDocument.getElementsByTagName("*"):e.getElementsByTagName("*"),o(e);for(let e=0,n=t.length;e<n;e++)o(t[e])}}function i(e){if(e&&e.getElementsByTagName){let t,o,r,a,i,l,s=e.getElementsByTagName("*");for(let f=0,c=s.length;f<=c;f++)if((t=f<c?s[f]:e).dataset&&t.dataset.length)for(let e=0,s=(o=d.getApplicable(t)).length;e<s;e++)a=(r=o[e]).parseParam(t.dataset[r.name]),(l=(i=y[a.tieName][r.name][a.dataPath.join(".")]).indexOf(t))>=0&&(i.splice(l,1),r.changeDOMEventType&&n(t,r.changeDOMEventType))}}function l(e,t,n,o){let a,i,l=-1;a=d.get(t).parseParam(n),y[a.tieName]&&y[a.tieName][t]&&((i=y[a.tieName][t][a.dataPath])&&(l=i.indexOf(e)),l>=0&&i.splice(l,1)),a=d.get(t).parseParam(o),y[a.tieName]||(y[a.tieName]={}),y[a.tieName][t]||(y[a.tieName][t]={}),y[a.tieName][t][a.dataPath]||(y[a.tieName][t][a.dataPath]=[]),y[a.tieName][t][a.dataPath].push(e),r(e,t)}function s(e,t){let n,o,a,i,l,s,f,c,u,p,h,g,v,b,w,m,P,O=y[e];if(O)for(p=0,h=t.length;p<h;p++)for(o=(n=t[p]).path.join("."),g=0,v=(a=Object.keys(O)).length;g<v;g++)if(i=a[g],c=O[i])for(l=d.get(i),b=0,w=(s=Object.keys(c)).length;b<w;b++)if(f=s[b],l.isChangedPathRelevant(o,f))for(m=0,P=(u=c[f]).length;m<P;m++)r(u[m],i)}function f(e){g[e.name]&&(g[e.name].forEach(o),delete g[e.name])}function c(e){let t,n=2,o=e.split("-");for(t=o[1];n<o.length;)t+=o[n][0].toUpperCase()+o[n++].substr(1);return t}function u(e){new MutationObserver(function(e){let t,n,o,r,s,f,p,h,d,y;for(t=0;t<e.length;t++)if(f=e[t],"attributes"===(p=f.type)){let e=f.target,t=f.attributeName;0===t.indexOf("data-tie")?l(e,c(t),f.oldValue,e.getAttribute(t)):"src"===t&&"IFRAME"===e.nodeName&&i(e.contentDocument)}else if("childList"===p){for(n=0,r=(h=f.addedNodes).length;n<r;n++)"IFRAME"===(y=h[n]).nodeName?(y.contentDocument&&(u(y.contentDocument),a(y.contentDocument)),y.addEventListener("load",function(){u(this.contentDocument),a(this.contentDocument)})):a(y);for(o=0,s=(d=f.removedNodes).length;o<s;o++)i("IFRAME"===(y=d[o]).nodeName?y.contentDocument:y)}}).observe(e,{childList:!0,attributes:!0,characterData:!1,subtree:!0,attributeOldValue:!0,characterDataOldValue:!1})}const p=this||window;if(!p.DataTier)throw new Error("data-tier framework was not properly initialized");const h=p.DataTier.ties,d=p.DataTier.processors,y={},g={};Reflect.defineProperty(p.DataTier,"views",{value:{get processChanges(){return s},get applyProcessor(){return f},get updateView(){return r}}}),u(document),a(document)})(),(()=>{"use strict";const e=this||window,t=e.DataTier.processors.add;if(!e.DataTier)throw new Error("data-tier framework was not properly initialized");t("tieValue",{toView:function(e,t){"checkbox"===t.type?t.checked=e:t.value=void 0!==e&&null!==e?e:""},changeDOMEventType:"change"}),t("tieText",{toView:function(e,t){t.textContent=void 0!==e&&null!==e?e:""}}),t("tiePlaceholder",{toView:function(e,t){t.placeholder=void 0!==e&&null!==e?e:""}}),t("tieTooltip",{toView:function(e,t){t.title=void 0!==e&&null!==e?e:""}}),t("tieSrc",{toView:function(e,t){t.src=void 0!==e&&null!==e?e:""}}),t("tieHRef",{toView:function(e,t){t.href=void 0!==e&&null!==e?e:""}}),t("tieDateValue",{toView:function(e,t){t.value=void 0!==e&&null!==e?e.toLocaleString():""}}),t("tieDateText",{toView:function(e,t){t.textContent=void 0!==e&&null!==e?e.toLocaleString():""}}),t("tieClasses",{isChangedPathRelevant:function(e,t){let n=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===n.length||2===n.length&&""===n[0]},toView:function(e,t){e&&"object"==typeof e&&Object.keys(e).forEach(function(n){e[n]?t.classList.add(n):t.classList.remove(n)})}}),t("tieList",{parseParam:function(e){return this.constructor.prototype.parseParam(e.split(/\s*=>\s*/)[0])},isChangedPathRelevant:function(e,t){let n=e.replace(t,"").split(".");return this.constructor.prototype.isChangedPathRelevant(e,t)||1===n.length||2===n.length&&""===n[0]},toView:function(t,n){if(!Array.isArray(t)||!n)return;let o,r,a,i,l,s,f,c=n.parentNode,u=t.length;if("TEMPLATE"!==n.nodeName)throw new Error("tieList may be defined on template elements only");n.dataset.listSourceAid||(n.dataset.listSourceAid=(new Date).getTime());let p=c.querySelectorAll('[data-list-item-aid="'+n.dataset.listSourceAid+'"]');for(f=p.length;f>u;)c.removeChild(p[--f]);if(f<u)if((r=n.dataset.tieList.trim().split(/\s+/))&&3===r.length&&"=>"===r[1]){a=r[2],l=(i=n.ownerDocument).createDocumentFragment();let e,t,p,h,d,y,g,v,b,w,m,P=[],O=r[0]+".";for(;f<u;f++){if(o=i.importNode(n.content,!0),e=o.querySelectorAll("*"),t||(t=e.length),!P.length)for(p=0;p<t;p++){for(h=Object.keys(e[p].dataset),d=[],y=0;y<h.length;y++)d.push([h[y],e[p].dataset[h[y]]]);P.push(d)}for(g=0;v=P[g];g++)for(w=0,b=v.length;w<b;w++)(m=v[w])[1].startsWith(a)&&(e[g].dataset[m[0]]=m[1].replace(a,O+f));for(l.appendChild(o),s=l.lastChild;s.nodeType!==Node.ELEMENT_NODE&&null!==s.previousSibling;)s=s.previousSibling;s.dataset.listItemAid=n.dataset.listSourceAid}c.appendChild(l)}else console.error('invalid parameter for "tieList" rule specified');let h,d,y,g,v=c.querySelectorAll("*");for(let t,o=0,r=v.length;o<r;o++)if((t=v[o])!==n&&t.parentNode!==n)for(d=0,y=(h=Object.keys(t.dataset)).length;d<y;d++)0===(g=h[d]).indexOf("tie")&&e.DataTier.views.updateView(t,g)}})})();